<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ† DeepStats PRO v3.3</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Orbitron:wght@400;600;700;900&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
    :root {
      --bg:#060b18; --bg-card:#0b1225; --gold:#f5b800; --gold2:#ffd700;
      --blue:#00c8f8; --purple:#9b5de5; --green:#00e676; --red:#ff3d57;
      --white:#f0f4ff; --muted:rgba(200,215,255,0.5);
      --border:rgba(255,255,255,0.08); --border-gold:rgba(245,184,0,0.3);
    }
    body { font-family:'Space Grotesk',sans-serif; background:var(--bg); color:var(--white); overflow-x:hidden; min-height:100vh; }

    .bg-layer {
      position:fixed; inset:0; z-index:0; pointer-events:none;
      background: radial-gradient(ellipse 80% 60% at 10% 20%,rgba(155,93,229,0.12) 0%,transparent 60%),
                  radial-gradient(ellipse 60% 80% at 90% 80%,rgba(0,200,248,0.10) 0%,transparent 60%);
      animation:bgBreath 18s ease-in-out infinite;
    }
    .bg-grid {
      position:fixed; inset:0; z-index:0; pointer-events:none;
      background-image:linear-gradient(rgba(255,255,255,0.025) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,0.025) 1px,transparent 1px);
      background-size:60px 60px;
      mask-image:radial-gradient(ellipse at center,black 30%,transparent 80%);
    }
    @keyframes bgBreath { 0%,100%{opacity:.6} 50%{opacity:1} }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       FIXED NAV â€” ÑĞºÑ€Ğ¸Ğ²Ğ° ÑĞµ Ğ¿Ñ€Ğ¸ ÑĞºÑ€Ğ¾Ğ» Ğ½Ğ°Ğ´Ğ¾Ğ»Ñƒ
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .nav-auth {
      position: fixed !important;
      top: 14px;
      left: 14px;
      z-index: 999999;
      pointer-events: auto;
      transition: opacity 0.35s ease, transform 0.35s ease;
    }
    .nav-lang {
      position: fixed !important;
      top: 14px;
      right: 14px;
      z-index: 999999;
      display: flex;
      gap: 4px;
      background: rgba(6,11,24,0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: 30px;
      padding: 4px;
      pointer-events: auto;
      transition: opacity 0.35s ease, transform 0.35s ease;
    }
    .nav-hidden {
      opacity: 0 !important;
      transform: translateY(-60px) !important;
      pointer-events: none !important;
    }
    .auth-btn {
      display: flex; align-items: center; gap: 7px;
      padding: 9px 18px;
      background: rgba(6,11,24,0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--border-gold);
      border-radius: 30px;
      color: var(--white); font-weight: 600; font-size: 13px;
      cursor: pointer;
      transition: background .3s, color .3s, border-color .3s;
      white-space: nowrap;
    }
    .auth-btn:hover { background:var(--gold); color:var(--bg); border-color:var(--gold); }
    .auth-btn.user-mode { border-color:var(--purple); background:rgba(155,93,229,0.15); }
    .lang-btn {
      padding: 6px 14px; border: none; border-radius: 26px;
      background: transparent; color: var(--muted);
      font-weight: 700; font-size: 11px; cursor: pointer; transition: all .3s;
    }
    .lang-btn.active {
      background: linear-gradient(135deg,var(--gold),var(--gold2));
      color: var(--bg); box-shadow: 0 2px 12px rgba(245,184,0,.45);
    }

    .tg-float {
      position:fixed; bottom:24px; right:24px; z-index:99999;
      width:52px; height:52px; border-radius:50%;
      background:rgba(0,200,248,0.15); border:2px solid var(--blue);
      display:flex; align-items:center; justify-content:center;
      font-size:24px; text-decoration:none;
      animation:floatPulse 2.5s ease-in-out infinite; transition:all .3s;
    }
    .tg-float:hover { background:var(--blue); transform:scale(1.1); }
    @keyframes floatPulse { 0%,100%{box-shadow:0 0 0 0 rgba(0,200,248,.6)} 50%{box-shadow:0 0 0 14px rgba(0,200,248,0)} }

    /* â”€â”€ MODALS â”€â”€ */
    .modal-overlay {
      display:none; position:fixed; inset:0; z-index:500000;
      background:rgba(0,0,0,.88); backdrop-filter:blur(12px);
      align-items:center; justify-content:center; padding:20px;
    }
    .modal-overlay.active { display:flex; }
    .modal-box {
      background:var(--bg-card); border:1px solid var(--border);
      border-radius:20px; padding:32px; position:relative; width:100%;
      max-width:480px; box-shadow:0 30px 80px rgba(0,0,0,.6);
      animation:modalIn .35s cubic-bezier(.34,1.56,.64,1);
    }
    .modal-box.wide { max-width:960px; }
    .modal-box.tall { max-width:820px; max-height:90vh; overflow-y:auto; }
    @keyframes modalIn { from{opacity:0;transform:scale(.88) translateY(20px)} to{opacity:1;transform:scale(1) translateY(0)} }
    .modal-close {
      position:absolute; top:14px; right:14px;
      background:rgba(255,255,255,.06); border:none;
      color:var(--muted); font-size:18px; cursor:pointer;
      width:34px; height:34px; border-radius:50%;
      display:flex; align-items:center; justify-content:center;
      transition:all .3s; line-height:1;
    }
    .modal-close:hover { background:var(--red); color:#fff; transform:rotate(90deg); }

    /* â”€â”€ AUTH â”€â”€ */
    .auth-tabs { display:flex; margin-bottom:24px; border-bottom:2px solid var(--border); }
    .auth-tab { flex:1; padding:12px; background:none; border:none; color:var(--muted); font-weight:700; font-size:14px; cursor:pointer; border-bottom:3px solid transparent; margin-bottom:-2px; transition:all .3s; }
    .auth-tab.active { color:var(--gold); border-bottom-color:var(--gold); }
    .auth-input { width:100%; padding:13px 15px; margin-bottom:14px; background:rgba(255,255,255,.04); border:1.5px solid var(--border); border-radius:11px; color:var(--white); font-size:14px; outline:none; transition:border .3s; }
    .auth-input:focus { border-color:var(--gold); }
    .auth-submit { width:100%; padding:14px; background:var(--gold); color:var(--bg); border:none; border-radius:11px; font-weight:700; font-size:15px; cursor:pointer; transition:all .3s; }
    .auth-submit:hover { transform:translateY(-2px); box-shadow:0 8px 24px rgba(245,184,0,.4); }
    .auth-switch { text-align:center; margin-top:14px; font-size:13px; color:var(--muted); }
    .auth-switch span { color:var(--gold); cursor:pointer; font-weight:700; }

    /* â”€â”€ LAYOUT â”€â”€ */
    .container { max-width:1400px; margin:0 auto; padding:20px; position:relative; z-index:10; }
    .site-header { text-align:center; padding:80px 0 50px; }
    .channel-badge { display:inline-flex; align-items:center; gap:8px; background:linear-gradient(135deg,rgba(245,184,0,.15),rgba(245,184,0,.05)); border:1px solid var(--border-gold); color:var(--gold); padding:7px 20px; border-radius:40px; font-weight:700; font-size:12px; text-decoration:none; margin-bottom:18px; transition:all .3s; letter-spacing:.5px; }
    .channel-badge:hover { background:var(--gold); color:var(--bg); transform:translateY(-2px); }
    .main-title { font-family:'Orbitron',sans-serif; font-size:clamp(36px,6vw,58px); font-weight:900; letter-spacing:-1px; line-height:1.1; background:linear-gradient(135deg,var(--gold) 0%,var(--blue) 50%,var(--purple) 100%); background-size:200%; -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation:gradShift 7s ease infinite; }
    @keyframes gradShift { 0%,100%{background-position:0%} 50%{background-position:100%} }
    .subtitle { font-size:13px; letter-spacing:4px; text-transform:uppercase; color:var(--muted); margin-top:10px; }

    .glass-card { background:rgba(11,18,37,.7); backdrop-filter:blur(24px); border:1px solid var(--border); border-radius:20px; padding:28px; margin-bottom:24px; }
    .section-title { font-family:'Orbitron',sans-serif; font-size:17px; font-weight:700; display:flex; align-items:center; gap:10px; margin-bottom:22px; color:var(--white); }

    /* â”€â”€ STAT CARDS â”€â”€ */
    .stats-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(175px,1fr)); gap:16px; margin-bottom:28px; }
    .stat-card { position:relative; background:linear-gradient(145deg,rgba(14,24,48,.95),rgba(8,13,28,.95)); border:1px solid var(--border); border-radius:18px; padding:26px 18px; cursor:pointer; overflow:hidden; transition:all .45s cubic-bezier(.4,0,.2,1); }
    .stat-card::before { content:''; position:absolute; inset:-1px; border-radius:18px; background:conic-gradient(from 0deg,transparent 0%,var(--gold) 20%,transparent 40%); opacity:0; animation:spinBorder 3s linear infinite; transition:opacity .4s; }
    @keyframes spinBorder { to{transform:rotate(360deg)} }
    .stat-card:hover::before { opacity:1; }
    .stat-card::after { content:''; position:absolute; inset:1px; border-radius:17px; background:linear-gradient(145deg,rgba(14,24,48,.98),rgba(8,13,28,.98)); z-index:0; }
    .stat-card:hover { transform:translateY(-10px) scale(1.03); box-shadow:0 24px 50px rgba(245,184,0,.2); }
    .stat-inner { position:relative; z-index:1; }
    .stat-icon { font-size:36px; display:block; margin-bottom:12px; animation:floatIcon 3.5s ease-in-out infinite; }
    @keyframes floatIcon { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
    .stat-label { font-size:10px; text-transform:uppercase; letter-spacing:2px; color:var(--muted); font-weight:600; margin-bottom:10px; }
    .stat-val { font-family:'Orbitron',sans-serif; font-size:clamp(26px,3vw,34px); font-weight:900; background:linear-gradient(135deg,var(--gold),var(--blue),var(--purple)); background-size:200%; -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation:gradShift 6s ease infinite; }

    /* â”€â”€ CHART MODAL â”€â”€ */
    .chart-wrap-lg { position:relative; height:420px; margin-top:8px; }

    @media(max-width:760px) {
      #chartModal2 .modal-box > div { grid-template-columns: 1fr !important; }
    }

    /* â”€â”€ PREDICTIONS TABS â”€â”€ */
    .pred-tabs { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; }
    .pred-tab { padding:13px 10px; background:rgba(255,255,255,.04); border:1.5px solid var(--border); border-radius:12px; color:var(--muted); font-weight:700; font-size:13px; cursor:pointer; transition:all .3s; text-align:center; font-family:'Orbitron',sans-serif; letter-spacing:.5px; }
    .pred-tab:not(.disabled):hover { background:rgba(245,184,0,.1); border-color:var(--gold); color:var(--white); transform:translateY(-3px); }
    .pred-tab.disabled { opacity:.3; cursor:not-allowed; }

    /* â”€â”€ FILTERS â”€â”€ */
    .filters-toggle { display:flex; justify-content:space-between; align-items:center; cursor:pointer; user-select:none; }
    .arrow { font-size:20px; color:var(--gold); transition:transform .4s; }
    .arrow.open { transform:rotate(180deg); }
    .filters-body { max-height:0; overflow:hidden; transition:max-height .5s ease,opacity .4s ease; opacity:0; }
    .filters-body.open { max-height:700px; opacity:1; margin-top:22px; }
    .filter-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:16px; margin-bottom:20px; }
    .filter-label { display:block; font-size:11px; font-weight:700; text-transform:uppercase; letter-spacing:1.5px; color:var(--muted); margin-bottom:7px; }
    input[type="date"], select { width:100%; padding:11px 13px; background:rgba(255,255,255,.04); border:1.5px solid var(--border); border-radius:10px; color:var(--white); outline:none; font-size:13px; transition:border .3s; }
    input[type="date"]:focus, select:focus { border-color:var(--gold); }
    select option { background:var(--bg-card); }
    .btn-row { display:flex; flex-wrap:wrap; gap:10px; }
    .btn { padding:11px 20px; font-size:12px; font-weight:700; letter-spacing:.8px; text-transform:uppercase; border:none; border-radius:10px; cursor:pointer; transition:all .3s; }
    .btn-gold { background:var(--gold); color:var(--bg); }
    .btn-gold:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(245,184,0,.35); }
    .btn-ghost { background:rgba(255,255,255,.07); color:var(--white); border:1.5px solid var(--border); }
    .btn-ghost:hover { background:rgba(255,255,255,.12); transform:translateY(-2px); }
    .btn-green { background:var(--green); color:var(--bg); }
    .btn-green:hover { transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,230,118,.3); }

    /* â”€â”€ MARKET CARDS â”€â”€ */
    .market-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(270px,1fr)); gap:16px; margin-top:20px; }
    .market-card { background:rgba(14,24,48,.6); border:1.5px solid var(--border); border-radius:16px; padding:20px; cursor:pointer; transition:all .35s; }
    .market-card:hover { border-color:var(--gold); transform:translateY(-6px); box-shadow:0 16px 40px rgba(245,184,0,.2); }
    .market-name { font-family:'Orbitron',sans-serif; font-size:16px; font-weight:700; background:linear-gradient(135deg,var(--gold),var(--blue)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:14px; }
    .mrow { display:flex; justify-content:space-between; margin:7px 0; font-size:13px; }
    .mrow .lbl { color:var(--muted); }

    /* â”€â”€ TABLE â”€â”€ */
    .table-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; }
    .data-table { width:100%; border-collapse:collapse; font-size:13px; min-width:680px; }
    .data-table thead { background:linear-gradient(135deg,rgba(155,93,229,.15),rgba(0,200,248,.15)); position:sticky; top:0; z-index:5; }
    .data-table th { padding:15px 12px; text-align:left; font-weight:700; text-transform:uppercase; letter-spacing:.7px; font-size:10px; color:rgba(255,255,255,.85); border-bottom:2px solid var(--border-gold); white-space:nowrap; }
    .data-table td { padding:13px 12px; border-bottom:1px solid rgba(255,255,255,.04); color:rgba(255,255,255,.8); }
    .data-table tbody tr { transition:background .2s; }
    .data-table tbody tr:hover { background:rgba(255,255,255,.04); }

    /* â”€â”€ COMMENTS â”€â”€ */
    .comment-card { background:rgba(255,255,255,.04); border:1.5px solid var(--border); border-radius:14px; padding:18px; margin-bottom:12px; transition:border .3s; }
    .comment-card:hover { border-color:rgba(245,184,0,.25); }
    .comment-head { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
    .comment-user { display:flex; align-items:center; gap:8px; font-weight:700; }
    .comment-user.is-admin { color:var(--gold); }
    .admin-badge { background:var(--gold); color:var(--bg); padding:2px 8px; border-radius:6px; font-size:10px; font-weight:900; }
    .comment-time { font-size:12px; color:var(--muted); }
    .comment-body { color:rgba(255,255,255,.8); font-size:14px; line-height:1.6; margin-bottom:10px; white-space:pre-wrap; word-break:break-word; }
    .comment-actions { display:flex; gap:10px; }
    .action-btn { background:none; border:none; color:var(--muted); font-size:12px; font-weight:600; cursor:pointer; padding:4px 8px; border-radius:6px; transition:all .2s; }
    .action-btn:hover { color:var(--gold); background:rgba(245,184,0,.1); }
    .reply-indent { margin-left:22px; margin-top:10px; padding-left:14px; border-left:2px solid rgba(245,184,0,.25); }
    .reply-box { background:rgba(0,0,0,.2); border:1.5px solid var(--border); border-radius:10px; padding:13px; margin-top:10px; }
    .reply-textarea { width:100%; min-height:68px; padding:10px; background:rgba(0,0,0,.25); border:1.5px solid var(--border); border-radius:8px; color:var(--white); font-size:13px; resize:vertical; outline:none; margin-bottom:9px; transition:border .3s; }
    .reply-textarea:focus { border-color:var(--gold); }

    /* â”€â”€ LOADERS â”€â”€ */
    .loader-wrap { display:flex; flex-direction:column; align-items:center; justify-content:center; padding:50px; gap:16px; }
    .spinner { width:44px; height:44px; border:3px solid rgba(255,255,255,.08); border-top-color:var(--gold); border-radius:50%; animation:spin .9s linear infinite; }
    @keyframes spin { to{transform:rotate(360deg)} }
    .empty-state { text-align:center; padding:50px 20px; color:var(--muted); }
    .empty-icon { font-size:52px; margin-bottom:14px; opacity:.5; display:block; }

    /* â”€â”€ PRED ITEMS â”€â”€ */
    .pred-list { display:grid; gap:12px; }
    .pred-item { background:rgba(255,255,255,.04); border:1.5px solid var(--border); border-radius:13px; padding:18px; transition:border .3s; }
    .pred-item:hover { border-color:var(--border-gold); }
    .pred-match { font-size:16px; font-weight:700; margin-bottom:12px; }
    .pred-meta { display:grid; grid-template-columns:repeat(auto-fit,minmax(110px,1fr)); gap:8px; font-size:12px; }
    .meta-lbl { color:var(--muted); font-size:10px; text-transform:uppercase; letter-spacing:.8px; margin-bottom:2px; }
    .meta-val { font-weight:700; }

    .badge { display:inline-block; padding:3px 10px; border-radius:6px; font-size:11px; font-weight:700; }
    .badge-market { background:rgba(155,93,229,.2); color:#c084fc; }
    .badge-won { background:rgba(0,230,118,.15); color:var(--green); }
    .badge-lost { background:rgba(255,61,87,.15); color:var(--red); }

    /* â”€â”€ DAILY CARD â”€â”€ */
    .daily-card {
      background: linear-gradient(145deg,rgba(14,24,48,.95),rgba(8,13,28,.95));
      border: 2px solid var(--border-gold);
      border-radius: 20px; padding: 30px; text-align: center;
    }
    .daily-teams {
      font-family:'Orbitron',sans-serif;
      font-size: clamp(18px,3vw,28px);
      font-weight: 900; color: var(--white);
      margin-bottom: 8px; line-height: 1.3;
    }
    .daily-vs { color: var(--muted); font-size: 14px; margin: 0 10px; }
    .daily-meta-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px,1fr));
      gap: 12px; margin: 22px 0;
    }
    .daily-meta-box {
      background: rgba(255,255,255,.05);
      border: 1px solid var(--border);
      border-radius: 12px; padding: 14px 10px; text-align: center;
    }
    .daily-meta-icon { font-size: 22px; margin-bottom: 6px; display:block; }
    .daily-meta-label { font-size: 10px; text-transform:uppercase; letter-spacing:1.5px; color:var(--muted); margin-bottom:5px; }
    .daily-meta-value { font-size: 14px; font-weight: 700; color: var(--white); }
    .daily-odds-wrap {
      margin-top: 10px; padding-top: 20px;
      border-top: 1px solid var(--border);
    }
    .daily-odds-label { font-size:11px; text-transform:uppercase; letter-spacing:2px; color:var(--muted); margin-bottom:8px; }
    .daily-odds-val {
      font-family:'Orbitron',sans-serif;
      font-size: 52px; font-weight: 900;
      background: linear-gradient(135deg,var(--gold),var(--gold2));
      -webkit-background-clip:text; -webkit-text-fill-color:transparent;
    }

    .comment-form-box { background:rgba(245,184,0,.06); border:1.5px solid var(--border-gold); border-radius:14px; padding:20px; margin-bottom:22px; }
    .big-textarea { width:100%; min-height:100px; padding:13px; background:rgba(0,0,0,.3); border:1.5px solid var(--border); border-radius:10px; color:var(--white); font-size:14px; resize:vertical; outline:none; transition:border .3s; }
    .big-textarea:focus { border-color:var(--gold); }
    .char-row { display:flex; justify-content:space-between; align-items:center; margin-top:10px; }
    .char-count { font-size:12px; color:var(--muted); }
    .login-prompt { text-align:center; padding:38px 20px; background:rgba(155,93,229,.06); border:1.5px dashed rgba(155,93,229,.3); border-radius:14px; margin-bottom:22px; }

    .site-footer { margin-top:60px; padding:30px 15px; text-align:center; border-top:1px solid var(--border); }
    .footer-title { font-family:'Orbitron',sans-serif; font-size:22px; font-weight:900; background:linear-gradient(135deg,var(--gold),var(--blue)); -webkit-background-clip:text; -webkit-text-fill-color:transparent; margin-bottom:8px; }

    @keyframes fadeInUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
    .fade-in { animation:fadeInUp .5s ease both; }

    @media(max-width:768px) {
      .stats-grid { grid-template-columns:repeat(2,1fr); gap:10px; }
      .stat-card { padding:20px 14px; } .stat-icon { font-size:28px; } .stat-val { font-size:26px; }
      .pred-tabs { grid-template-columns:repeat(2,1fr); gap:8px; } .pred-tab { font-size:11px; padding:11px 8px; }
      .filter-grid { grid-template-columns:1fr; } .market-grid { grid-template-columns:1fr; }
      .glass-card { padding:18px; }
    }
    @media(max-width:480px) {
      .container { padding:14px; } .site-header { padding:70px 0 40px; }
      .btn-row { flex-direction:column; } .btn { width:100%; text-align:center; }
    }
  </style>
</head>

<body>
  <div class="bg-layer"></div>
  <div class="bg-grid"></div>

  <!-- â•â• FIXED NAV â•â• -->
  <div class="nav-auth" id="navAuth">
    <button class="auth-btn" id="authBtn" onclick="openAuthModal()">ğŸ” <span data-i18n="signIn">Sign In</span></button>
    <button class="auth-btn user-mode" id="userBtn" style="display:none" onclick="doLogout()">ğŸ‘¤ <span id="uname">User</span></button>
  </div>
  <div class="nav-lang" id="navLang">
    <button class="lang-btn active" id="lEN" onclick="switchLang('en')">EN</button>
    <button class="lang-btn" id="lBG" onclick="switchLang('bg')">Ğ‘Ğ“</button>
  </div>
  <a href="https://t.me/DeepStats_Admin" target="_blank" class="tg-float">ğŸ’¬</a>

  <!-- AUTH MODAL -->
  <div class="modal-overlay" id="authModal">
    <div class="modal-box">
      <button class="modal-close" onclick="closeModal('authModal')">âœ•</button>
      <div class="auth-tabs">
        <button class="auth-tab active" id="tabIn" onclick="switchTab('in')" data-i18n="signIn">Sign In</button>
        <button class="auth-tab" id="tabUp" onclick="switchTab('up')" data-i18n="signUp">Sign Up</button>
      </div>
      <form onsubmit="handleAuth(event)">
        <input class="auth-input" id="aUser" type="text" placeholder="Username" required>
        <input class="auth-input" id="aPass" type="password" placeholder="Password" required>
        <button class="auth-submit" id="aSubmit" type="submit" data-i18n="signIn">Sign In</button>
      </form>
      <div class="auth-switch" id="authSwitch"></div>
    </div>
  </div>

  <!-- CHARTS â€” 5 Ğ¾Ñ‚Ğ´ĞµĞ»Ğ½Ğ¸ Ğ¼Ğ¾Ğ´Ğ°Ğ»Ğ°, Ğ²ÑĞµĞºĞ¸ Ñ Ñ€Ğ°Ğ·Ğ»Ğ¸Ñ‡Ğ½Ğ° Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ° -->
  <!-- Modal 1: Total Bets -->
  <div class="modal-overlay" id="chartModal1" onclick="handleOverlayClick(event,'chartModal1')">
    <div class="modal-box wide">
      <button class="modal-close" onclick="closeChartModal('chartModal1')">âœ•</button>
      <div class="section-title">ğŸ“Š <span data-i18n="totalBets">Total Bets</span></div>
      <div class="chart-wrap-lg"><canvas id="chart1"></canvas></div>
    </div>
  </div>
  <!-- Modal 2: Win Rate -->
  <div class="modal-overlay" id="chartModal2" onclick="handleOverlayClick(event,'chartModal2')">
    <div class="modal-box wide">
      <button class="modal-close" onclick="closeChartModal('chartModal2')">âœ•</button>
      <div class="section-title">ğŸ¯ <span data-i18n="winRate">Win Rate</span></div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;align-items:center">
        <div class="chart-wrap-lg"><canvas id="chart2"></canvas></div>
        <div id="winRateStats"></div>
      </div>
    </div>
  </div>
  <!-- Modal 3: ROI -->
  <div class="modal-overlay" id="chartModal3" onclick="handleOverlayClick(event,'chartModal3')">
    <div class="modal-box wide">
      <button class="modal-close" onclick="closeChartModal('chartModal3')">âœ•</button>
      <div class="section-title">ğŸ“ˆ <span data-i18n="roi">ROI by Market</span></div>
      <div class="chart-wrap-lg"><canvas id="chart3"></canvas></div>
    </div>
  </div>
  <!-- Modal 4: Cumulative Profit -->
  <div class="modal-overlay" id="chartModal4" onclick="handleOverlayClick(event,'chartModal4')">
    <div class="modal-box wide">
      <button class="modal-close" onclick="closeChartModal('chartModal4')">âœ•</button>
      <div class="section-title">ğŸ’° <span data-i18n="totalProfit">Cumulative Profit</span></div>
      <div class="chart-wrap-lg"><canvas id="chart4"></canvas></div>
    </div>
  </div>
  <!-- Modal 5: Odds Distribution -->
  <div class="modal-overlay" id="chartModal5" onclick="handleOverlayClick(event,'chartModal5')">
    <div class="modal-box wide">
      <button class="modal-close" onclick="closeChartModal('chartModal5')">âœ•</button>
      <div class="section-title">ğŸ² <span data-i18n="avgOdds">Odds Distribution</span></div>
      <div class="chart-wrap-lg"><canvas id="chart5"></canvas></div>
    </div>
  </div>

  <!-- MARKET MODAL -->
  <div class="modal-overlay" id="marketModal">
    <div class="modal-box tall">
      <button class="modal-close" onclick="closeModal('marketModal')">âœ•</button>
      <div class="section-title">ğŸ“Š <span id="marketModalTitle">Market</span></div>
      <div id="marketModalBody"></div>
    </div>
  </div>

  <!-- PREDICTIONS MODAL -->
  <div class="modal-overlay" id="predModal">
    <div class="modal-box tall">
      <button class="modal-close" onclick="closeModal('predModal')">âœ•</button>
      <div class="section-title">ğŸ”® <span id="predModalTitle">Predictions</span></div>
      <div id="predModalBody"></div>
    </div>
  </div>

  <!-- MAIN -->
  <div class="container">
    <div class="site-header">
      <a href="https://t.me/+h7FMPplHXGFkN2I0" target="_blank" class="channel-badge">ğŸ† <span data-i18n="joinChannel">Join Premium Channel</span></a>
      <h1 class="main-title">DeepStats PRO</h1>
      <p class="subtitle" data-i18n="subtitle">Professional AI Betting System</p>
    </div>

    <!-- STAT CARDS -->
    <div class="stats-grid">
      <div class="stat-card" onclick="openChart(1)">
        <div class="stat-inner"><span class="stat-icon">ğŸ“Š</span><div class="stat-label" data-i18n="totalBets">Total Bets</div><div class="stat-val" id="sTotalBets">0</div></div>
      </div>
      <div class="stat-card" onclick="openChart(2)">
        <div class="stat-inner"><span class="stat-icon">ğŸ¯</span><div class="stat-label" data-i18n="winRate">Win Rate</div><div class="stat-val" id="sWinRate">0%</div></div>
      </div>
      <div class="stat-card" onclick="openChart(3)">
        <div class="stat-inner"><span class="stat-icon">ğŸ“ˆ</span><div class="stat-label" data-i18n="roi">ROI</div><div class="stat-val" id="sROI">+0%</div></div>
      </div>
      <div class="stat-card" onclick="openChart(4)">
        <div class="stat-inner"><span class="stat-icon">ğŸ’°</span><div class="stat-label" data-i18n="totalProfit">Total Profit</div><div class="stat-val" id="sProfit">+0.00</div></div>
      </div>
      <div class="stat-card" onclick="openChart(5)">
        <div class="stat-inner"><span class="stat-icon">ğŸ²</span><div class="stat-label" data-i18n="avgOdds">Avg Odds</div><div class="stat-val" id="sOdds">0.000</div></div>
      </div>
      <div class="stat-card" onclick="loadAllData()" style="cursor:pointer">
        <div class="stat-inner"><span class="stat-icon">âš¡</span><div class="stat-label" data-i18n="loadAll">Load All</div><div class="stat-val" id="sLoaded">0</div></div>
      </div>
    </div>

    <!-- PREDICTIONS -->
    <div class="glass-card">
      <div class="section-title">ğŸ”® <span data-i18n="predictions">Predictions</span></div>
      <div class="pred-tabs">
        <button class="pred-tab" onclick="showPredictions('acca')">ACCA</button>
        <button class="pred-tab" onclick="showPredictions('daily')">DAILY</button>
        <button class="pred-tab" onclick="showPredictions('value')">VALUE</button>
        <button class="pred-tab disabled" data-i18n="trends">TRENDS</button>
      </div>
    </div>

    <!-- FILTERS -->
    <div class="glass-card">
      <div class="filters-toggle" onclick="toggleFilters()">
        <div class="section-title" style="margin-bottom:0">ğŸ” <span data-i18n="filters">Advanced Filters</span></div>
        <span class="arrow open" id="fArrow">â–¼</span>
      </div>
      <div class="filters-body open" id="filtersBody" style="max-height:700px;opacity:1;margin-top:22px">
        <div class="filter-grid">
          <div><label class="filter-label" data-i18n="from">ğŸ“… From</label><input type="date" id="dFrom"></div>
          <div><label class="filter-label" data-i18n="to">ğŸ“… To</label><input type="date" id="dTo"></div>
          <div><label class="filter-label" data-i18n="market">ğŸ¯ Market</label><select id="mktFilter"><option value=""></option></select></div>
          <div><label class="filter-label" data-i18n="league">ğŸ† League</label><select id="lgFilter"><option value=""></option></select></div>
        </div>
        <div class="btn-row">
          <button class="btn btn-gold" onclick="applyFilters()" data-i18n="apply">Apply</button>
          <button class="btn btn-ghost" onclick="resetFilters()" data-i18n="reset">Reset</button>
          <button class="btn btn-green" onclick="exportCSV('7d')" data-i18n="export7d">ğŸ“¥ 7 Days</button>
          <button class="btn btn-green" onclick="exportCSV('30d')" data-i18n="export30d">ğŸ“¥ 30 Days</button>
          <button class="btn btn-green" onclick="exportCSV('custom')" data-i18n="exportCustom">ğŸ“¥ Custom</button>
        </div>
      </div>
    </div>

    <!-- MARKET PERFORMANCE -->
    <div class="glass-card">
      <div class="section-title">ğŸ“Š <span data-i18n="perfByMarket">Performance by Market</span></div>
      <div class="market-grid" id="marketGrid">
        <div class="loader-wrap"><div class="spinner"></div><span style="color:var(--muted)" data-i18n="loading">Loading...</span></div>
      </div>
    </div>

    <!-- LAST 20 BETS -->
    <div class="glass-card">
      <div class="section-title">ğŸ¯ <span data-i18n="last20">Last 20 Bets</span></div>
      <div class="table-wrap">
        <table class="data-table">
          <thead><tr>
            <th data-i18n="date">ğŸ“… Date</th>
            <th data-i18n="match">âš½ Match</th>
            <th data-i18n="market">ğŸ¯ Market</th>
            <th data-i18n="odds">ğŸ’° Odds</th>
            <th data-i18n="result">ğŸ“Š Result</th>
            <th data-i18n="profit">ğŸ’µ Profit</th>
          </tr></thead>
          <tbody id="betsBody"><tr><td colspan="6"><div class="loader-wrap"><div class="spinner"></div></div></td></tr></tbody>
        </table>
      </div>
    </div>

    <!-- COMMENTS -->
    <div class="glass-card">
      <div class="section-title">ğŸ’¬ <span data-i18n="community">Community</span></div>
      <div id="cFormWrap" style="display:none">
        <div class="comment-form-box">
          <textarea class="big-textarea" id="cInput" maxlength="500" data-i18n-placeholder="shareThoughts"></textarea>
          <div class="char-row">
            <span class="char-count" id="cCount">0 / 500</span>
            <button class="btn btn-gold" onclick="postComment()">ğŸ’¬ <span data-i18n="post">Post</span></button>
          </div>
        </div>
      </div>
      <div id="cLoginPrompt" class="login-prompt">
        <div style="font-size:44px;margin-bottom:12px;opacity:.6">ğŸ”’</div>
        <h3 style="font-size:17px;margin-bottom:8px" data-i18n="loginToJoin">Login to join</h3>
        <p style="font-size:13px;color:var(--muted);margin-bottom:18px" data-i18n="loginDesc">Share predictions and insights</p>
        <button class="btn btn-gold" onclick="openAuthModal()">ğŸ” <span data-i18n="signIn">Sign In</span></button>
      </div>
      <div id="cList"><div class="loader-wrap"><div class="spinner"></div></div></div>
    </div>

    <div class="site-footer">
      <div class="footer-title">DeepStats PRO v3.3</div>
      <p style="color:var(--muted);font-size:13px;margin-bottom:6px" data-i18n="subtitle">Professional AI Betting System</p>
      <p style="color:rgba(255,255,255,.3);font-size:11px">Â© 2026 DeepStats PRO. All Rights Reserved.</p>
    </div>
  </div>

  <script>
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  i18n â€” Ğ•Ğ—Ğ˜ĞšĞĞ’Ğ˜ Ğ¢Ğ•ĞšĞ¡Ğ¢ĞĞ’Ğ•
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var LANG = 'en';
  var T = {
    en: {
      signIn:'Sign In', signUp:'Sign Up', logout:'Logout',
      statistics:'Statistics', predictions:'Predictions', trends:'TRENDS',
      totalBets:'Total Bets', winRate:'Win Rate', roi:'ROI',
      totalProfit:'Total Profit', avgOdds:'Avg Odds', loadAll:'Load All',
      filters:'Advanced Filters', from:'ğŸ“… From', to:'ğŸ“… To',
      market:'ğŸ¯ Market', league:'ğŸ† League', allMarkets:'All Markets', allLeagues:'All Leagues',
      apply:'Apply', reset:'Reset',
      export7d:'ğŸ“¥ 7 Days', export30d:'ğŸ“¥ 30 Days', exportCustom:'ğŸ“¥ Custom',
      perfByMarket:'Performance by Market', last20:'Last 20 Bets',
      date:'ğŸ“… Date', match:'âš½ Match', odds:'ğŸ’° Odds', result:'ğŸ“Š Result', profit:'ğŸ’µ Profit',
      community:'Community', post:'Post', loginToJoin:'Login to join',
      loginDesc:'Share predictions and insights', shareThoughts:'Share your thoughts...',
      loading:'Loading...', noData:'No data',
      joinChannel:'Join Premium Channel', subtitle:'Professional AI Betting System',
      won:'Won', lost:'Lost', total:'Total', avgOddsShort:'Avg Odds',
      matchesLabel:'Matches', totalOdds:'Total Odds',
      noActiveBets:'NO ACTIVE VALUE BETS', checkBack:'Check back soon',
      noDaily:'COMING SOON', noDailyDesc:'No active daily prediction',
      noAcca:'NEXT ACCA COMING SOON', noAccaDesc:'No active ACCA coupon',
      home:'Home', away:'Away', country:'Country', leagueLabel:'League',
      dateTime:'Date & Time', marketLabel:'Market', oddsLabel:'Odds',
      // chart titles
      chartProfit:'Cumulative Profit', chartWinLoss:'Win / Loss Distribution',
      chartMarkets:'Bets by Market', chartROI:'ROI by Market', chartOdds:'Odds Distribution',
      // kpis
      kpiStreak:'Current Streak', kpiAvgOdds:'Average Odds',
      // auth
      noAccount:"Don't have an account?", hasAccount:'Already have an account?',
      signUpLink:'Sign up', signInLink:'Sign in',
      // reply/delete
      reply:'â†©ï¸ Reply', delete:'ğŸ—‘ï¸ Delete',
      confirmLogout:'Logout?', confirmDelete:'Delete?',
      writeSomething:'Write something!', errorPost:'Error posting comment',
      errorReply:'Error posting reply', errorDelete:'Error deleting',
      loadedAll:'Loaded all records!', exportSuccess:'bets exported',
      noExport:'No data to export!',
    },
    bg: {
      signIn:'Ğ’Ñ…Ğ¾Ğ´', signUp:'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ', logout:'Ğ˜Ğ·Ñ…Ğ¾Ğ´',
      statistics:'Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ°', predictions:'ĞŸÑ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¸', trends:'Ğ¢Ğ•ĞĞ”Ğ•ĞĞ¦Ğ˜Ğ˜',
      totalBets:'ĞĞ±Ñ‰Ğ¾ Ğ—Ğ°Ğ»Ğ¾Ğ·Ğ¸', winRate:'Ğ£ÑĞ¿ĞµĞ²Ğ°ĞµĞ¼Ğ¾ÑÑ‚', roi:'ROI',
      totalProfit:'ĞĞ±Ñ‰Ğ° ĞŸĞµÑ‡Ğ°Ğ»Ğ±Ğ°', avgOdds:'Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸ ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¸', loadAll:'Ğ—Ğ°Ñ€ĞµĞ´Ğ¸ Ğ’ÑĞ¸Ñ‡ĞºĞ¾',
      filters:'Ğ Ğ°Ğ·ÑˆĞ¸Ñ€ĞµĞ½Ğ¸ Ğ¤Ğ¸Ğ»Ñ‚Ñ€Ğ¸', from:'ğŸ“… ĞÑ‚', to:'ğŸ“… Ğ”Ğ¾',
      market:'ğŸ¯ ĞŸĞ°Ğ·Ğ°Ñ€', league:'ğŸ† Ğ›Ğ¸Ğ³Ğ°', allMarkets:'Ğ’ÑĞ¸Ñ‡ĞºĞ¸ ĞŸĞ°Ğ·Ğ°Ñ€Ğ¸', allLeagues:'Ğ’ÑĞ¸Ñ‡ĞºĞ¸ Ğ›Ğ¸Ğ³Ğ¸',
      apply:'ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶Ğ¸', reset:'ĞÑƒĞ»Ğ¸Ñ€Ğ°Ğ¹',
      export7d:'ğŸ“¥ 7 Ğ”Ğ½Ğ¸', export30d:'ğŸ“¥ 30 Ğ”Ğ½Ğ¸', exportCustom:'ğŸ“¥ ĞŸĞ¾ Ğ˜Ğ·Ğ±Ğ¾Ñ€',
      perfByMarket:'ĞŸÑ€ĞµĞ´ÑÑ‚Ğ°Ğ²ÑĞ½Ğµ Ğ¿Ğ¾ ĞŸĞ°Ğ·Ğ°Ñ€', last20:'ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸ 20 Ğ—Ğ°Ğ»Ğ¾Ğ³Ğ°',
      date:'ğŸ“… Ğ”Ğ°Ñ‚Ğ°', match:'âš½ ĞœĞ°Ñ‡', odds:'ğŸ’° ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚', result:'ğŸ“Š Ğ ĞµĞ·ÑƒĞ»Ñ‚Ğ°Ñ‚', profit:'ğŸ’µ ĞŸĞµÑ‡Ğ°Ğ»Ğ±Ğ°',
      community:'ĞĞ±Ñ‰Ğ½Ğ¾ÑÑ‚', post:'ĞŸÑƒĞ±Ğ»Ğ¸ĞºÑƒĞ²Ğ°Ğ¹', loginToJoin:'Ğ’Ğ»ĞµĞ·Ñ‚Ğµ Ğ·Ğ° Ğ´Ğ¾ÑÑ‚ÑŠĞ¿',
      loginDesc:'Ğ¡Ğ¿Ğ¾Ğ´ĞµĞ»ÑĞ¹ Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ¸ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸', shareThoughts:'Ğ¡Ğ¿Ğ¾Ğ´ĞµĞ»Ğ¸ ÑĞ²Ğ¾Ğ¸Ñ‚Ğµ Ğ¼Ğ¸ÑĞ»Ğ¸...',
      loading:'Ğ—Ğ°Ñ€ĞµĞ¶Ğ´Ğ°...', noData:'ĞÑĞ¼Ğ° Ğ´Ğ°Ğ½Ğ½Ğ¸',
      joinChannel:'ĞŸÑ€Ğ¸ÑÑŠĞµĞ´Ğ¸Ğ½Ğ¸ ÑĞµ ĞºÑŠĞ¼ ĞšĞ°Ğ½Ğ°Ğ»Ğ°', subtitle:'ĞŸÑ€Ğ¾Ñ„ĞµÑĞ¸Ğ¾Ğ½Ğ°Ğ»Ğ½Ğ° AI Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ·Ğ° Ğ—Ğ°Ğ»Ğ¾Ğ·Ğ¸',
      won:'Ğ¡Ğ¿ĞµÑ‡ĞµĞ»ĞµĞ½Ğ¸', lost:'Ğ—Ğ°Ğ³ÑƒĞ±ĞµĞ½Ğ¸', total:'ĞĞ±Ñ‰Ğ¾', avgOddsShort:'Ğ¡Ñ€. ĞšĞ¾ĞµÑ„.',
      matchesLabel:'ĞœĞ°Ñ‡Ğ¾Ğ²Ğµ', totalOdds:'ĞĞ±Ñ‰Ğ¸ ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¸',
      noActiveBets:'ĞĞ¯ĞœĞ ĞĞšĞ¢Ğ˜Ğ’ĞĞ˜ VALUE Ğ—ĞĞ›ĞĞ—Ğ˜', checkBack:'ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸ Ğ¾Ñ‚Ğ½Ğ¾Ğ²Ğ¾ Ğ¿Ğ¾-ĞºÑŠÑĞ½Ğ¾',
      noDaily:'ĞĞ§ĞĞšĞ’ĞĞ™Ğ¢Ğ• Ğ¡ĞšĞĞ Ğ', noDailyDesc:'ĞÑĞ¼Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ° Ğ´Ğ½ĞµĞ²Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ³Ğ½Ğ¾Ğ·Ğ°',
      noAcca:'Ğ¡Ğ›Ğ•Ğ”Ğ’ĞĞ©ĞĞ¢Ğ ĞĞšĞ£ĞœĞ£Ğ›ĞĞ¢ĞĞ  Ğ˜Ğ”Ğ’Ğ Ğ¡ĞšĞĞ Ğ', noAccaDesc:'ĞÑĞ¼Ğ° Ğ°ĞºÑ‚Ğ¸Ğ²ĞµĞ½ Ğ°ĞºÑƒĞ¼ÑƒĞ»Ğ°Ñ‚Ğ¾Ñ€',
      home:'Ğ”Ğ¾Ğ¼Ğ°ĞºĞ¸Ğ½', away:'Ğ“Ğ¾ÑÑ‚', country:'Ğ”ÑŠÑ€Ğ¶Ğ°Ğ²Ğ°', leagueLabel:'Ğ›Ğ¸Ğ³Ğ°',
      dateTime:'Ğ”Ğ°Ñ‚Ğ° Ğ¸ Ğ§Ğ°Ñ', marketLabel:'ĞŸĞ°Ğ·Ğ°Ñ€', oddsLabel:'ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚',
      chartProfit:'ĞšÑƒĞ¼ÑƒĞ»Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ° ĞŸĞµÑ‡Ğ°Ğ»Ğ±Ğ°', chartWinLoss:'Ğ¡Ğ¿ĞµÑ‡ĞµĞ»ĞµĞ½Ğ¸ / Ğ—Ğ°Ğ³ÑƒĞ±ĞµĞ½Ğ¸',
      chartMarkets:'Ğ—Ğ°Ğ»Ğ¾Ğ·Ğ¸ Ğ¿Ğ¾ ĞŸĞ°Ğ·Ğ°Ñ€', chartROI:'ROI Ğ¿Ğ¾ ĞŸĞ°Ğ·Ğ°Ñ€', chartOdds:'Ğ Ğ°Ğ·Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¸Ñ‚Ğµ',
      kpiStreak:'Ğ¢ĞµĞºÑƒÑ‰Ğ° Ğ¡ĞµÑ€Ğ¸Ñ', kpiAvgOdds:'Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸ ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¸',
      noAccount:'ĞÑĞ¼Ğ°Ñ‚Ğµ Ğ°ĞºĞ°ÑƒĞ½Ñ‚?', hasAccount:'Ğ’ĞµÑ‡Ğµ Ğ¸Ğ¼Ğ°Ñ‚Ğµ Ğ°ĞºĞ°ÑƒĞ½Ñ‚?',
      signUpLink:'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ°Ğ¹Ñ‚Ğµ ÑĞµ', signInLink:'Ğ’Ğ»ĞµĞ·Ñ‚Ğµ',
      reply:'â†©ï¸ ĞÑ‚Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸', delete:'ğŸ—‘ï¸ Ğ˜Ğ·Ñ‚Ñ€Ğ¸Ğ¹',
      confirmLogout:'Ğ˜Ğ·Ñ…Ğ¾Ğ´?', confirmDelete:'Ğ˜Ğ·Ñ‚Ñ€Ğ¸Ğ²Ğ°Ğ½Ğµ?',
      writeSomething:'ĞĞ°Ğ¿Ğ¸ÑˆĞµÑ‚Ğµ Ğ½ĞµÑ‰Ğ¾!', errorPost:'Ğ“Ñ€ĞµÑˆĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºÑƒĞ²Ğ°Ğ½Ğµ',
      errorReply:'Ğ“Ñ€ĞµÑˆĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ñ‚Ğ³Ğ¾Ğ²Ğ¾Ñ€', errorDelete:'Ğ“Ñ€ĞµÑˆĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ñ‚Ñ€Ğ¸Ğ²Ğ°Ğ½Ğµ',
      loadedAll:'Ğ’ÑĞ¸Ñ‡ĞºĞ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ·Ğ°Ñ€ĞµĞ´ĞµĞ½Ğ¸!', exportSuccess:'Ğ·Ğ°Ğ»Ğ¾Ğ³Ğ° ĞµĞºÑĞ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ°Ğ½Ğ¸',
      noExport:'ĞÑĞ¼Ğ° Ğ´Ğ°Ğ½Ğ½Ğ¸ Ğ·Ğ° ĞµĞºÑĞ¿Ğ¾Ñ€Ñ‚!',
    }
  };

  function t(key) { return (T[LANG] && T[LANG][key]) ? T[LANG][key] : (T.en[key] || key); }

  function applyLang() {
    // data-i18n ĞµĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¸
    document.querySelectorAll('[data-i18n]').forEach(function(el) {
      var key = el.getAttribute('data-i18n');
      el.textContent = t(key);
    });
    // placeholders
    document.querySelectorAll('[data-i18n-placeholder]').forEach(function(el) {
      var key = el.getAttribute('data-i18n-placeholder');
      el.placeholder = t(key);
    });
    // auth switch
    updateAuthSwitch();
    // filter placeholders
    var mktEl = document.getElementById('mktFilter');
    if (mktEl && mktEl.options[0]) mktEl.options[0].text = t('allMarkets');
    var lgEl = document.getElementById('lgFilter');
    if (lgEl && lgEl.options[0]) lgEl.options[0].text = t('allLeagues');
  }

  function switchLang(l) {
    LANG = l;
    document.getElementById('lEN').classList.toggle('active', l === 'en');
    document.getElementById('lBG').classList.toggle('active', l === 'bg');
    applyLang();
  }

  function updateAuthSwitch() {
    var tabMode = document.getElementById('tabIn').classList.contains('active') ? 'in' : 'up';
    if (tabMode === 'in') {
      document.getElementById('authSwitch').innerHTML = t('noAccount') + ' <span onclick="switchTab(\'up\')">' + t('signUpLink') + '</span>';
    } else {
      document.getElementById('authSwitch').innerHTML = t('hasAccount') + ' <span onclick="switchTab(\'in\')">' + t('signInLink') + '</span>';
    }
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  CONFIG
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxr6bxu60cvJrMc0ZLSmIBy62gTMEsV7EydIgPY1u8Zkqbu5983JM90Mlzz8RSQC8Ol/exec';

  var SUPA_URL = 'https://eipouebrtpkncjcnxarh.supabase.co';
  var SUPA_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVpcG91ZWJydHBrbmNqY254YXJoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExNTE2MzAsImV4cCI6MjA4NjcyNzYzMH0.sBTe7Sx-eW4Zl-36Bmupj5vwb0JelAe6MldaJ5YbNO8';

  var TABLE_NEW = 'matches';
  var TABLE_OLD = 'statistics';

  var VALUE_SHEETS = [
    { name:'HOME WIN',  key:'HOME WIN'  },
    { name:'AWAY WIN',  key:'AWAY WIN'  },
    { name:'UNDER 2.5', key:'UNDER 2.5' },
    { name:'OVER 4.5',  key:'OVER 4.5'  },
    { name:'OVER 2.5',  key:'OVER 2.5'  },
    { name:'BTTS',      key:'BTTS'      }
  ];

  var { createClient } = supabase;
  var db = createClient(SUPA_URL, SUPA_KEY);

  var currentUser = null;
  var allMatches  = [];
  var filtered    = [];
  var totalLoaded = 0;

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  UTILS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function normMkt(m) {
    if (!m) return 'Unknown';
    var u = m.toUpperCase().trim();
    if (u.includes('HOME') || u === '1') return 'HOME WIN';
    if (u.includes('AWAY') || u === '2') return 'AWAY WIN';
    if (u.includes('UNDER') && u.includes('2')) return 'UNDER 2.5';
    if (u.includes('OVER') && u.includes('2')) return 'OVER 2.5';
    if (u.includes('BTTS') || u.includes('GG')) return 'BTTS';
    if (u.includes('OVER') && u.includes('4')) return 'OVER 4.5';
    return m;
  }
  function escHtml(v) { var d=document.createElement('div'); d.textContent=String(v||''); return d.innerHTML; }
  function timeAgo(ts) {
    var s=Math.floor((Date.now()-new Date(ts))/1000);
    if(s<60)return'just now'; if(s<3600)return Math.floor(s/60)+'m ago';
    if(s<86400)return Math.floor(s/3600)+'h ago'; if(s<604800)return Math.floor(s/86400)+'d ago';
    return new Date(ts).toLocaleDateString('en-GB');
  }
  function fmtKickoff(v) {
    if(!v)return'N/A'; var d=new Date(v);
    return isNaN(d.getTime())?String(v):d.toLocaleDateString('en-GB');
  }
  function fmtKickoffFull(v) {
    if(!v)return'N/A'; var d=new Date(v);
    if(isNaN(d.getTime()))return String(v);
    return d.toLocaleDateString('en-GB') + ' ' + d.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
  }
  function kickoffToDate(v) { if(!v)return null; var d=new Date(v); return isNaN(d.getTime())?null:d; }
  function normalizeRow(row, source) {
    var d = kickoffToDate(row.kickoff);
    return {
      id:          source+'_'+(row.id||Math.random()),
      match_date:  d?d.toISOString():null,
      kickoff_raw: row.kickoff,
      home_team:   row.home_team||row.home||'',
      away_team:   row.away_team||row.away||'',
      market:      row.market||'',
      odds:        row.odds||row.closing_odds||0,
      result:      row.result||'',
      profit:      row.profit||0,
      competition: row.competition||row.league||'',
      _source:     source
    };
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  APPS SCRIPT FETCH
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  async function fetchSheet(sheetKey) {
    if(!APPS_SCRIPT_URL)throw new Error('Apps Script URL not set');
    var r=await fetch(APPS_SCRIPT_URL+'?sheet='+encodeURIComponent(sheetKey));
    if(!r.ok)throw new Error('HTTP '+r.status);
    var json=await r.json();
    if(json.error)throw new Error(json.error);
    return json.rows||[];
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  AUTH
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function openAuthModal() { document.getElementById('authModal').classList.add('active'); updateAuthSwitch(); }
  function closeModal(id) { document.getElementById(id).classList.remove('active'); }
  function switchTab(mode) {
    var isIn=(mode==='in');
    document.getElementById('tabIn').classList.toggle('active',isIn);
    document.getElementById('tabUp').classList.toggle('active',!isIn);
    document.getElementById('aSubmit').textContent=isIn?t('signIn'):t('signUp');
    updateAuthSwitch();
  }
  function handleAuth(e) {
    e.preventDefault();
    var user=document.getElementById('aUser').value.trim();
    var pass=document.getElementById('aPass').value;
    currentUser=(user==='admin'&&pass==='Bold_9000')?{username:'Admin ğŸ‘‘',isAdmin:true}:{username:user,isAdmin:false};
    document.getElementById('authBtn').style.display='none';
    document.getElementById('userBtn').style.display='flex';
    document.getElementById('uname').textContent=currentUser.username;
    closeModal('authModal'); syncCommentsUI(); loadComments();
  }
  function doLogout() {
    if(!confirm(t('confirmLogout')))return;
    currentUser=null;
    document.getElementById('authBtn').style.display='flex';
    document.getElementById('userBtn').style.display='none';
    syncCommentsUI();
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  STATS + ANIMATE
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function calcAndShow(data) {
    var withRes=data.filter(function(m){return m.result&&m.result!=='';});
    var won=withRes.filter(function(m){return m.result==='WON';}).length;
    var profit=withRes.reduce(function(s,m){return s+(parseFloat(m.profit)||0);},0);
    var total=withRes.length;
    var wr=total>0?(won/total*100).toFixed(1):'0.0';
    var roi=total>0?(profit/total*100).toFixed(1):'0.0';
    var oddsSum=0,oddsN=0;
    withRes.forEach(function(m){if(m.odds&&!isNaN(m.odds)&&parseFloat(m.odds)>0){oddsSum+=parseFloat(m.odds);oddsN++;}});
    var avgOdds=oddsN>0?(oddsSum/oddsN).toFixed(3):'0.000';
    animNum('sTotalBets',0,total,1400,'');
    animNum('sWinRate',0,parseFloat(wr),1400,'%');
    animNum('sROI',0,parseFloat(roi),1400,'%',true);
    animNum('sProfit',0,profit,1400,'',true,2);
    animNum('sOdds',0,parseFloat(avgOdds),1400,'',false,3);
    document.getElementById('sLoaded').textContent=totalLoaded;
  }
  function animNum(id,from,to,dur,suf,sign,dec) {
    sign=sign||false; dec=dec||0;
    var el=document.getElementById(id); if(!el)return;
    var t0=performance.now();
    function tick(now){
      var p=Math.min((now-t0)/dur,1),ease=1-Math.pow(1-p,4),v=from+(to-from)*ease;
      var str=dec>0?v.toFixed(dec):Math.round(v);
      el.textContent=(sign&&to>0?'+':'')+str+suf;
      if(p<1)requestAnimationFrame(tick);
    }
    requestAnimationFrame(tick);
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  SCROLL â€” ÑĞºÑ€Ğ¸Ğ²Ğ° Ğ½Ğ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸ÑÑ‚Ğ° Ğ¿Ñ€Ğ¸ ÑĞºÑ€Ğ¾Ğ» Ğ½Ğ°Ğ´Ğ¾Ğ»Ñƒ
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var lastScrollY = 0;
  window.addEventListener('scroll', function() {
    var y = window.scrollY || window.pageYOffset;
    var navAuth = document.getElementById('navAuth');
    var navLang = document.getElementById('navLang');
    if (y > 80) {
      navAuth.classList.add('nav-hidden');
      navLang.classList.add('nav-hidden');
    } else {
      navAuth.classList.remove('nav-hidden');
      navLang.classList.remove('nav-hidden');
    }
    lastScrollY = y;
  }, { passive: true });

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  CHART INSTANCES â€” Ğ¿Ğ¾ ĞµĞ´Ğ¸Ğ½ Ğ·Ğ° Ğ²ÑĞµĞºĞ¸ Ğ¼Ğ¾Ğ´Ğ°Ğ»
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  var chartInstances = { 1:null, 2:null, 3:null, 4:null, 5:null };

  function handleOverlayClick(e, modalId) {
    // Ğ—Ğ°Ñ‚Ğ²Ğ°Ñ€Ñ ÑĞ°Ğ¼Ğ¾ Ğ°ĞºĞ¾ Ğµ ĞºĞ»Ğ¸ĞºĞ½Ğ°Ñ‚Ğ¾ Ğ”Ğ˜Ğ Ğ•ĞšĞ¢ĞĞ Ğ²ÑŠÑ€Ñ…Ñƒ overlay-Ğ° (Ğ½Ğµ Ğ²ÑŠÑ€Ñ…Ñƒ ÑÑŠĞ´ÑŠÑ€Ğ¶Ğ°Ğ½Ğ¸ĞµÑ‚Ğ¾)
    if (e.target === e.currentTarget) {
      closeChartModal(modalId);
    }
  }

  function closeChartModal(modalId) {
    document.getElementById(modalId).classList.remove('active');
    var num = parseInt(modalId.replace('chartModal',''));
    if (chartInstances[num]) {
      try { chartInstances[num].destroy(); } catch(e) {}
      chartInstances[num] = null;
    }
  }

  function openChart(num) {
    // Ğ£Ğ½Ğ¸Ñ‰Ğ¾Ğ¶Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ¸ÑˆĞ½Ğ°Ñ‚Ğ° Ğ¸Ğ½ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ Ğ°ĞºĞ¾ Ğ¸Ğ¼Ğ°
    if (chartInstances[num]) {
      try { chartInstances[num].destroy(); } catch(e) {}
      chartInstances[num] = null;
    }

    document.getElementById('chartModal' + num).classList.add('active');

    var withRes = filtered.filter(function(m) { return m.result && m.result !== ''; });
    var won  = withRes.filter(function(m) { return m.result === 'WON'; }).length;
    var lost = withRes.filter(function(m) { return m.result === 'LOST'; }).length;
    var total = withRes.length;
    var profit = withRes.reduce(function(s,m) { return s + (parseFloat(m.profit)||0); }, 0);

    setTimeout(function() {
      var ctx = document.getElementById('chart' + num);
      if (!ctx) return;
      var c = ctx.getContext('2d');

      if (num === 1) {
        // â”€â”€ RADAR / SPIDER â€” Ğ·Ğ°Ğ»Ğ¾Ğ·Ğ¸ Ğ¸ win rate Ğ¿Ğ¾ Ğ¿Ğ°Ğ·Ğ°Ñ€ â”€â”€
        var mktData = {};
        filtered.forEach(function(m) {
          var k = normMkt(m.market);
          if (!mktData[k]) mktData[k] = { n:0, won:0 };
          mktData[k].n++;
          if (m.result === 'WON') mktData[k].won++;
        });
        var labels = Object.keys(mktData).sort(function(a,b){ return mktData[b].n - mktData[a].n; });
        var totalN  = labels.reduce(function(s,k){ return s + mktData[k].n; }, 0);
        var betsPct = labels.map(function(k){ return +(mktData[k].n / totalN * 100).toFixed(1); });
        var wrPct   = labels.map(function(k){
          return mktData[k].n > 0 ? +(mktData[k].won / mktData[k].n * 100).toFixed(1) : 0;
        });

        chartInstances[1] = new Chart(c, {
          type: 'radar',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'Ğ”ÑĞ» Ğ¾Ñ‚ Ğ±ĞµÑ‚Ğ¾Ğ²ĞµÑ‚Ğµ %',
                data: betsPct,
                backgroundColor: 'rgba(0,200,248,0.15)',
                borderColor: 'rgba(0,200,248,0.9)',
                borderWidth: 2.5,
                pointBackgroundColor: 'rgba(0,200,248,1)',
                pointRadius: 5,
                pointHoverRadius: 8
              },
              {
                label: 'Win Rate %',
                data: wrPct,
                backgroundColor: 'rgba(245,184,0,0.12)',
                borderColor: 'rgba(245,184,0,0.9)',
                borderWidth: 2.5,
                pointBackgroundColor: 'rgba(245,184,0,1)',
                pointRadius: 5,
                pointHoverRadius: 8
              }
            ]
          },
          options: {
            responsive: true, maintainAspectRatio: false,
            plugins: {
              legend: {
                position: 'bottom',
                labels: { color:'rgba(255,255,255,.8)', font:{size:12}, padding:20 }
              },
              tooltip: {
                callbacks: {
                  label: function(ctx) {
                    var k = ctx.chart.data.labels[ctx.dataIndex];
                    var d = mktData[k];
                    if (ctx.datasetIndex === 0) return ' Ğ‘ĞµÑ‚Ğ¾Ğ²Ğµ: ' + d.n + ' (' + ctx.raw + '%)';
                    return ' Win Rate: ' + ctx.raw + '%';
                  }
                }
              }
            },
            scales: {
              r: {
                min: 0,
                ticks: {
                  color: 'rgba(255,255,255,.45)',
                  backdropColor: 'transparent',
                  font: { size: 9 },
                  stepSize: 20
                },
                grid:        { color: 'rgba(255,255,255,.12)' },
                angleLines:  { color: 'rgba(255,255,255,.15)' },
                pointLabels: { color: 'rgba(255,255,255,.85)', font: { size: 12, weight: '600' } }
              }
            },
            animation: { duration: 1600, easing: 'easeOutBack' }
          }
        });

      } else if (num === 2) {
        // â”€â”€ Win / Loss â€” Doughnut + ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ â”€â”€
        var wr = total > 0 ? (won/total*100).toFixed(1) : '0.0';
        var grd1 = c.createLinearGradient(0,0,200,200);
        grd1.addColorStop(0,'rgba(0,230,118,.9)'); grd1.addColorStop(1,'rgba(0,200,120,.7)');
        var grd2 = c.createLinearGradient(0,0,200,200);
        grd2.addColorStop(0,'rgba(255,61,87,.9)'); grd2.addColorStop(1,'rgba(200,30,60,.7)');
        chartInstances[2] = new Chart(c, {
          type: 'doughnut',
          data: {
            labels: [t('won'), t('lost')],
            datasets: [{ data:[won,lost], backgroundColor:[grd1,grd2], borderWidth:0, hoverOffset:18 }]
          },
          options: {
            responsive:true, maintainAspectRatio:false, cutout:'68%',
            plugins: {
              legend: { position:'bottom', labels:{color:'rgba(255,255,255,.75)',font:{size:13},padding:20} },
              tooltip: { callbacks: { label: function(ctx) { return ctx.label+': '+ctx.raw+' ('+(ctx.raw/total*100).toFixed(1)+'%)'; } } }
            },
            animation: { duration:1800, easing:'easeOutBack' }
          }
        });
        // Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ¸ Ğ²Ğ´ÑÑĞ½Ğ¾
        var roiVal = total>0?(profit/total*100).toFixed(1):'0.0';
        var roiColor = parseFloat(roiVal)>=0?'var(--green)':'var(--red)';
        var profitColor = profit>=0?'var(--green)':'var(--red)';
        document.getElementById('winRateStats').innerHTML =
          statBox('ğŸ¯', t('winRate'), wr+'%', parseFloat(wr)>=50?'var(--green)':'var(--red)') +
          statBox('âœ…', t('won'), won, 'var(--green)') +
          statBox('âŒ', t('lost'), lost, 'var(--red)') +
          statBox('ğŸ“Š', t('total'), total, 'var(--blue)') +
          statBox('ğŸ“ˆ', 'ROI', (parseFloat(roiVal)>0?'+':'')+roiVal+'%', roiColor) +
          statBox('ğŸ’°', t('totalProfit'), (profit>0?'+':'')+profit.toFixed(2), profitColor);

      } else if (num === 3) {
        // â”€â”€ BUBBLE â€” Win Rate % (X) vs ROI % (Y), Ñ€Ğ¾Ğ·Ğ¼ĞµÑ€ = Ğ±Ñ€Ğ¾Ğ¹ Ğ±ĞµÑ‚Ğ¾Ğ²Ğµ â”€â”€
        var mktsROI = {};
        withRes.forEach(function(m) {
          var k = normMkt(m.market);
          if (!mktsROI[k]) mktsROI[k] = { p:0, n:0, won:0 };
          mktsROI[k].p += parseFloat(m.profit)||0;
          mktsROI[k].n++;
          if (m.result === 'WON') mktsROI[k].won++;
        });
        var palette3 = [
          'rgba(0,200,248,.82)','rgba(245,184,0,.82)','rgba(0,230,118,.82)',
          'rgba(155,93,229,.82)','rgba(255,61,87,.82)','rgba(255,165,0,.82)',
          'rgba(100,149,237,.82)','rgba(255,105,180,.82)'
        ];
        var mktKeys3 = Object.keys(mktsROI);
        var bubbleDatasets = mktKeys3.map(function(k, i) {
          var s   = mktsROI[k];
          var wr  = +(s.won / s.n * 100).toFixed(1);
          var roi = +(s.p   / s.n * 100).toFixed(1);
          var r   = Math.max(10, Math.min(44, s.n * 0.9));
          return {
            label: k,
            data: [{ x: wr, y: roi, r: r }],
            backgroundColor: palette3[i % palette3.length],
            borderColor:     palette3[i % palette3.length].replace('.82','1'),
            borderWidth: 1.5,
            _n:      s.n,
            _profit: +s.p.toFixed(2)
          };
        });
        // Zero lines plugin
        var zeroLinesPlugin = {
          id:'zeroLines',
          afterDraw: function(chart) {
            var ctx2 = chart.ctx;
            var xScale = chart.scales.x, yScale = chart.scales.y;
            ctx2.save();
            // Vertical line at x=50
            ctx2.beginPath();
            ctx2.strokeStyle = 'rgba(255,255,255,0.18)';
            ctx2.lineWidth = 1.5;
            ctx2.setLineDash([6,4]);
            var x50 = xScale.getPixelForValue(50);
            ctx2.moveTo(x50, yScale.top);
            ctx2.lineTo(x50, yScale.bottom);
            ctx2.stroke();
            // Horizontal line at y=0
            ctx2.beginPath();
            ctx2.strokeStyle = 'rgba(255,255,255,0.18)';
            var y0 = yScale.getPixelForValue(0);
            ctx2.moveTo(xScale.left, y0);
            ctx2.lineTo(xScale.right, y0);
            ctx2.stroke();
            ctx2.restore();
          }
        };
        chartInstances[3] = new Chart(c, {
          type: 'bubble',
          data: { datasets: bubbleDatasets },
          plugins: [zeroLinesPlugin],
          options: {
            responsive: true, maintainAspectRatio: false,
            plugins: {
              legend: { position:'bottom', labels:{ color:'rgba(255,255,255,.78)', font:{size:11}, padding:14 } },
              tooltip: {
                callbacks: {
                  label: function(ctx) {
                    var ds = ctx.dataset, pt = ctx.raw;
                    return [
                      ' ' + ds.label,
                      ' Win Rate: '  + pt.x + '%',
                      ' ROI: '       + (pt.y>0?'+':'') + pt.y + '%',
                      ' Ğ‘ĞµÑ‚Ğ¾Ğ²Ğµ: '    + ds._n,
                      ' ĞŸĞµÑ‡Ğ°Ğ»Ğ±Ğ°: '   + (ds._profit>0?'+':'') + ds._profit
                    ];
                  }
                }
              }
            },
            scales: {
              x: {
                title:{ display:true, text:'Win Rate %', color:'rgba(245,184,0,.8)', font:{size:12} },
                ticks:{ color:'rgba(255,255,255,.5)', callback:function(v){return v+'%';} },
                grid:{ color:'rgba(255,255,255,.07)' }
              },
              y: {
                title:{ display:true, text:'ROI %', color:'rgba(0,230,118,.8)', font:{size:12} },
                ticks:{ color:'rgba(255,255,255,.5)', callback:function(v){return v+'%';} },
                grid:{ color:'rgba(255,255,255,.07)' }
              }
            },
            animation:{ duration:1400, easing:'easeOutBack' }
          }
        });

      } else if (num === 4) {
        // â”€â”€ ĞšÑƒĞ¼ÑƒĞ»Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ° Ğ¿ĞµÑ‡Ğ°Ğ»Ğ±Ğ° â€” Line â”€â”€
        var sortedData = withRes.slice().sort(function(a,b){return new Date(a.match_date)-new Date(b.match_date);});
        var cum = 0;
        var pData = sortedData.map(function(m){cum+=parseFloat(m.profit)||0;return+cum.toFixed(2);});
        var step = Math.max(1,Math.floor(sortedData.length/30));
        var labels = sortedData.map(function(m,i){
          return i%step===0 ? new Date(m.match_date).toLocaleDateString('en-GB',{month:'short',day:'numeric'}) : '';
        });
        var grd = c.createLinearGradient(0,0,0,380);
        grd.addColorStop(0,'rgba(245,184,0,.35)'); grd.addColorStop(1,'rgba(245,184,0,.02)');
        chartInstances[4] = new Chart(c, {
          type: 'line',
          data: {
            labels: labels,
            datasets: [{
              label: t('totalProfit'),
              data: pData,
              borderColor: '#f5b800',
              backgroundColor: grd,
              fill: true, tension: .4, borderWidth: 2.5,
              pointRadius: 0, pointHoverRadius: 6,
              pointHoverBackgroundColor: '#f5b800'
            }]
          },
          options: {
            responsive:true, maintainAspectRatio:false,
            plugins: { legend:{labels:{color:'rgba(255,255,255,.7)',font:{size:12}}} },
            scales: {
              y: { ticks:{color:'rgba(255,255,255,.5)'}, grid:{color:'rgba(255,255,255,.07)'} },
              x: { ticks:{color:'rgba(255,255,255,.4)',maxRotation:0,font:{size:9}}, grid:{display:false} }
            },
            animation:{duration:2000,easing:'easeInOutQuart'}
          }
        });

      } else if (num === 5) {
        // â”€â”€ Ğ Ğ°Ğ·Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° ĞºĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚Ğ¸Ñ‚Ğµ â€” Polar Area â”€â”€
        var buckets = {'1.0â€“1.5':0,'1.5â€“2.0':0,'2.0â€“3.0':0,'3.0â€“5.0':0,'5.0+':0};
        filtered.forEach(function(m){
          var o=parseFloat(m.odds)||0;
          if(o<1.5)buckets['1.0â€“1.5']++;
          else if(o<2.0)buckets['1.5â€“2.0']++;
          else if(o<3.0)buckets['2.0â€“3.0']++;
          else if(o<5.0)buckets['3.0â€“5.0']++;
          else buckets['5.0+']++;
        });
        chartInstances[5] = new Chart(c, {
          type: 'polarArea',
          data: {
            labels: Object.keys(buckets),
            datasets: [{
              data: Object.values(buckets),
              backgroundColor: [
                'rgba(0,200,248,.75)',
                'rgba(155,93,229,.75)',
                'rgba(245,184,0,.75)',
                'rgba(0,230,118,.75)',
                'rgba(255,61,87,.75)'
              ],
              borderWidth: 0
            }]
          },
          options: {
            responsive:true, maintainAspectRatio:false,
            plugins: {
              legend: { position:'right', labels:{color:'rgba(255,255,255,.75)',font:{size:12},padding:16} }
            },
            scales: {
              r: { ticks:{color:'rgba(255,255,255,.4)',backdropColor:'transparent'}, grid:{color:'rgba(255,255,255,.1)'} }
            },
            animation:{duration:1600,easing:'easeOutBack'}
          }
        });
      }
    }, 60);
  }

  function statBox(icon, label, val, color) {
    return '<div style="background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:16px 14px;margin-bottom:10px;display:flex;align-items:center;gap:14px">'
      +'<span style="font-size:26px">'+icon+'</span>'
      +'<div><div style="font-size:10px;text-transform:uppercase;letter-spacing:1.5px;color:var(--muted);margin-bottom:4px">'+label+'</div>'
      +'<div style="font-family:Orbitron;font-size:20px;font-weight:900;color:'+color+'">'+val+'</div></div></div>';
  }

  // Legacy â€” Ğ½Ğµ ÑĞµ Ğ¸Ğ·Ğ¿Ğ¾Ğ»Ğ·Ğ²Ğ° Ğ¿Ğ¾Ğ²ĞµÑ‡Ğµ, Ğ½Ğ¾ Ğ·Ğ°Ğ¿Ğ°Ğ·ĞµĞ½ Ğ·Ğ° ÑÑŠĞ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚
  function openChartsModal() { openChart(1); }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  TABLE last 20
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function renderLast20(data) {
    var rows=data.filter(function(m){return m.result&&m.result!=='';})
      .sort(function(a,b){return new Date(b.match_date)-new Date(a.match_date);}).slice(0,20);
    if(!rows.length){document.getElementById('betsBody').innerHTML='<tr><td colspan="6" style="text-align:center;padding:30px;color:var(--muted)">'+t('noData')+'</td></tr>';return;}
    var html='';
    rows.forEach(function(m,i){
      var pVal=parseFloat(m.profit||0),pColor=pVal>0?'var(--green)':'var(--red)',pText=(pVal>0?'+':'')+pVal.toFixed(2),won=m.result==='WON';
      html+='<tr class="fade-in" style="animation-delay:'+(i*.04)+'s">'
        +'<td style="font-weight:600">'+fmtKickoff(m.kickoff_raw)+'</td>'
        +'<td style="font-weight:700">'+escHtml(m.home_team||'?')+' vs '+escHtml(m.away_team||'?')+'</td>'
        +'<td><span class="badge badge-market">'+normMkt(m.market)+'</span></td>'
        +'<td style="font-family:Orbitron;color:var(--gold);font-weight:700">'+parseFloat(m.odds||0).toFixed(3)+'</td>'
        +'<td><span class="badge '+(won?'badge-won':'badge-lost')+'">'+(won?'âœ…':'âŒ')+' '+m.result+'</span></td>'
        +'<td style="color:'+pColor+';font-weight:900;font-family:Orbitron">'+pText+'</td></tr>';
    });
    document.getElementById('betsBody').innerHTML=html;
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  MARKETS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function renderMarkets(data) {
    var ms={};
    data.filter(function(m){return m.result&&m.result!=='';}).forEach(function(m){
      var k=normMkt(m.market);
      if(!ms[k])ms[k]={total:0,won:0,lost:0,profit:0,oddsSum:0};
      ms[k].total++;
      if(m.result==='WON')ms[k].won++;else if(m.result==='LOST')ms[k].lost++;
      ms[k].profit+=parseFloat(m.profit)||0; ms[k].oddsSum+=parseFloat(m.odds)||0;
    });
    var keys=Object.keys(ms).sort();
    if(!keys.length){document.getElementById('marketGrid').innerHTML='<div class="empty-state"><span class="empty-icon">ğŸ“­</span>'+t('noData')+'</div>';return;}
    var html='';
    keys.forEach(function(name,i){
      var s=ms[name],wr=(s.won/s.total*100).toFixed(1),roi=(s.profit/s.total*100).toFixed(1),ao=(s.oddsSum/s.total).toFixed(3);
      var pc=s.profit>0?'var(--green)':'var(--red)',wrc=parseFloat(wr)>=50?'var(--green)':'var(--red)';
      html+='<div class="market-card fade-in" style="animation-delay:'+(i*.07)+'s" onclick="showMarketDetail(\''+name.replace(/'/g,"\\'")+'\')">'
        +'<div class="market-name">'+name+'</div>'
        +'<div class="mrow"><span class="lbl">'+t('total')+'</span><span>'+s.total+'</span></div>'
        +'<div class="mrow"><span class="lbl">'+t('won')+' / '+t('lost')+'</span><span><span style="color:var(--green)">'+s.won+'</span> / <span style="color:var(--red)">'+s.lost+'</span></span></div>'
        +'<div class="mrow"><span class="lbl">'+t('winRate')+'</span><span style="color:'+wrc+'">'+wr+'%</span></div>'
        +'<div class="mrow"><span class="lbl">ROI</span><span style="color:'+pc+'">'+(parseFloat(roi)>0?'+':'')+roi+'%</span></div>'
        +'<div class="mrow"><span class="lbl">'+t('avgOdds')+'</span><span>'+ao+'</span></div>'
        +'<div class="mrow"><span class="lbl">'+t('profit')+'</span><span style="color:'+pc+';font-weight:900;font-family:Orbitron">'+(s.profit>0?'+':'')+s.profit.toFixed(2)+'</span></div>'
        +'</div>';
    });
    document.getElementById('marketGrid').innerHTML=html;
  }

  function showMarketDetail(name) {
    var rows=filtered.filter(function(m){return normMkt(m.market)===name&&m.result;});
    if(!rows.length){alert(t('noData'));return;}
    var won=rows.filter(function(m){return m.result==='WON';}).length;
    var lost=rows.filter(function(m){return m.result==='LOST';}).length;
    var profit=rows.reduce(function(s,m){return s+(parseFloat(m.profit)||0);},0);
    var wr=(won/rows.length*100).toFixed(1),roi=(profit/rows.length*100).toFixed(1);
    var ao=(rows.reduce(function(s,m){return s+(parseFloat(m.odds)||0);},0)/rows.length).toFixed(3);
    var pc=profit>=0?'var(--green)':'var(--red)';
    var items=[[t('won'),won,'var(--green)'],[t('lost'),lost,'var(--red)'],[t('winRate'),wr+'%','var(--gold)'],['ROI',(parseFloat(roi)>0?'+':'')+roi+'%',pc],[t('avgOdds'),ao,'var(--purple)'],[t('profit'),(profit>0?'+':'')+profit.toFixed(2),pc]];
    var sum='<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:14px;margin-bottom:24px">';
    items.forEach(function(it){sum+='<div style="background:rgba(255,255,255,.05);border:1.5px solid rgba(255,255,255,.12);border-radius:12px;padding:16px;text-align:center"><div style="font-size:11px;color:var(--muted);margin-bottom:5px">'+it[0]+'</div><div style="font-size:26px;font-weight:900;color:'+it[2]+'">'+it[1]+'</div></div>';});
    sum+='</div>';
    var tbl='<div style="font-family:Orbitron;font-size:14px;margin-bottom:12px;color:var(--gold)">Last 10</div><div class="table-wrap"><table class="data-table"><thead><tr><th>'+t('date')+'</th><th>'+t('match')+'</th><th>'+t('odds')+'</th><th>'+t('result')+'</th><th>'+t('profit')+'</th></tr></thead><tbody>';
    rows.slice(0,10).forEach(function(m){
      var pVal=parseFloat(m.profit||0),pc2=pVal>=0?'var(--green)':'var(--red)',won2=m.result==='WON';
      tbl+='<tr><td>'+fmtKickoff(m.kickoff_raw)+'</td><td style="font-weight:700">'+escHtml(m.home_team)+' vs '+escHtml(m.away_team)+'</td><td style="color:var(--gold);font-weight:700">'+parseFloat(m.odds||0).toFixed(3)+'</td><td><span class="badge '+(won2?'badge-won':'badge-lost')+'">'+(won2?'âœ…':'âŒ')+' '+m.result+'</span></td><td style="color:'+pc2+';font-weight:900">'+(pVal>0?'+':'')+pVal.toFixed(2)+'</td></tr>';
    });
    tbl+='</tbody></table></div>';
    document.getElementById('marketModalTitle').textContent=name+' â€” Details';
    document.getElementById('marketModalBody').innerHTML=sum+tbl;
    document.getElementById('marketModal').classList.add('active');
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  FILTERS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function toggleFilters() {
    document.getElementById('filtersBody').classList.toggle('open');
    document.getElementById('fArrow').classList.toggle('open');
  }
  function initFilters() {
    var mktSeen={},mkts=[];
    allMatches.forEach(function(m){var k=normMkt(m.market);if(k&&!mktSeen[k]){mktSeen[k]=true;mkts.push(k);}});
    mkts.sort();
    var el=document.getElementById('mktFilter');
    el.innerHTML='<option value="">'+t('allMarkets')+'</option>';
    mkts.forEach(function(k){el.innerHTML+='<option value="'+k+'">'+k+'</option>';});
    var lgSeen={},lgs=[];
    allMatches.forEach(function(m){if(m.competition&&!lgSeen[m.competition]){lgSeen[m.competition]=true;lgs.push(m.competition);}});
    lgs.sort();
    var el2=document.getElementById('lgFilter');
    el2.innerHTML='<option value="">'+t('allLeagues')+'</option>';
    lgs.forEach(function(l){el2.innerHTML+='<option value="'+l+'">'+l+'</option>';});
  }
  function applyFilters() {
    var from=document.getElementById('dFrom').value,to=document.getElementById('dTo').value,mkt=document.getElementById('mktFilter').value,lg=document.getElementById('lgFilter').value;
    filtered=allMatches.filter(function(m){
      if(from||to){var d=new Date(m.match_date);if(from&&d<new Date(from))return false;if(to&&d>new Date(to+'T23:59:59'))return false;}
      if(mkt&&normMkt(m.market)!==mkt)return false;
      if(lg&&m.competition!==lg)return false;
      return true;
    });
    calcAndShow(filtered);renderMarkets(filtered);renderLast20(filtered);
  }
  function resetFilters() {
    document.getElementById('dFrom').value='';document.getElementById('dTo').value='';
    document.getElementById('mktFilter').value='';document.getElementById('lgFilter').value='';
    filtered=allMatches;calcAndShow(filtered);renderMarkets(filtered);renderLast20(filtered);
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  EXPORT
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function exportCSV(type) {
    var now=Date.now(),rows=[];
    if(type==='7d')rows=allMatches.filter(function(m){return now-new Date(m.match_date)<7*864e5;});
    else if(type==='30d')rows=allMatches.filter(function(m){return now-new Date(m.match_date)<30*864e5;});
    else rows=filtered;
    if(!rows.length){alert(t('noExport'));return;}
    var csv='Date,Home,Away,Market,Odds,Result,Profit\n';
    rows.forEach(function(m){csv+=fmtKickoff(m.kickoff_raw)+',"'+(m.home_team||'')+'","'+(m.away_team||'')+'","'+normMkt(m.market)+'",'+(m.odds||'')+','+(m.result||'')+','+(m.profit||0)+'\n';});
    var a=document.createElement('a');
    a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));
    a.download='DeepStats_'+type+'_'+new Date().toISOString().slice(0,10)+'.csv';
    a.click();
    alert(rows.length+' '+t('exportSuccess'));
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  SUPABASE LOAD
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  async function fetchTablePage(tableName,page,pageSize) {
    var res=await db.from(tableName).select('*').order('kickoff',{ascending:false}).range(page*pageSize,(page+1)*pageSize-1);
    if(res.error){console.warn('Error fetching '+tableName+':',res.error.message);return[];}
    return res.data||[];
  }
  async function loadInitial() {
    var PAGE=1000,combined=[];
    var newRows=await fetchTablePage(TABLE_NEW,0,PAGE);
    newRows.forEach(function(r){combined.push(normalizeRow(r,'new'));});
    var oldRows=await fetchTablePage(TABLE_OLD,0,PAGE);
    oldRows.forEach(function(r){combined.push(normalizeRow(r,'old'));});
    combined.sort(function(a,b){return new Date(b.match_date)-new Date(a.match_date);});
    return combined;
  }
  async function loadAllData() {
    document.getElementById('sLoaded').textContent='...';
    try {
      var PAGE=1000,combined=[];
      var pageN=0,moreN=true;
      while(moreN){var chunk=await fetchTablePage(TABLE_NEW,pageN,PAGE);chunk.forEach(function(r){combined.push(normalizeRow(r,'new'));});pageN++;if(chunk.length<PAGE)moreN=false;}
      var pageO=0,moreO=true;
      while(moreO){var chunk2=await fetchTablePage(TABLE_OLD,pageO,PAGE);chunk2.forEach(function(r){combined.push(normalizeRow(r,'old'));});pageO++;if(chunk2.length<PAGE)moreO=false;}
      combined.sort(function(a,b){return new Date(b.match_date)-new Date(a.match_date);});
      allMatches=combined;filtered=combined;totalLoaded=combined.length;
      calcAndShow(combined);renderMarkets(combined);renderLast20(combined);initFilters();
      alert(t('loadedAll')+' '+combined.length+' ('+TABLE_NEW+' + '+TABLE_OLD+')');
    }catch(err){console.error(err);alert('Error: '+err.message);}
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  PREDICTIONS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  async function showPredictions(type) {
    var body=document.getElementById('predModalBody');
    var titles={acca:'ğŸ† ACCA',daily:'ğŸ“… DAILY',value:'ğŸ’ VALUE'};
    document.getElementById('predModalTitle').textContent=titles[type]||type;
    body.innerHTML='<div class="loader-wrap"><div class="spinner"></div><span style="color:var(--muted)">'+t('loading')+'</span></div>';
    document.getElementById('predModal').classList.add('active');
    try {
      if(type==='acca')await renderACCA(body);
      if(type==='daily')await renderDaily(body);
      if(type==='value')await renderValue(body);
    }catch(e){
      console.error(e);
      body.innerHTML='<div class="empty-state"><span class="empty-icon">âš ï¸</span><div style="color:var(--gold);font-family:Orbitron;font-size:16px;margin-bottom:10px">Apps Script Error</div><div style="color:var(--muted);font-size:13px">'+escHtml(e.message)+'</div></div>';
    }
  }

  // â”€â”€â”€ DAILY â€” Ñ‚Ğ¾Ñ‡Ğ½Ğ¸ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¸ Ğ¾Ñ‚ ÑĞ½Ğ¸Ğ¼ĞºĞ°Ñ‚Ğ°:
  //   A(0)=date  B(1)=market  C(2)=home  D(3)=away
  //   E(4)=country  F(5)=league  G(6)=time  H(7)=odds
  //   I(8)=result  J(9)=profit
  async function renderDaily(container) {
    var rows = await fetchSheet('daily');
    var found = null;
    var foundIdx = -1;

    // Ğ¥ĞµĞ´ÑŠÑ€Ğ¸ ÑĞ° Ğ½Ğ° Ñ€ĞµĞ´ 7 Ğ² Sheet = Ğ¸Ğ½Ğ´ĞµĞºÑ 6 Ğ² Ğ¼Ğ°ÑĞ¸Ğ²Ğ°
    // Ğ”Ğ°Ğ½Ğ½Ğ¸Ñ‚Ğµ Ğ·Ğ°Ğ¿Ğ¾Ñ‡Ğ²Ğ°Ñ‚ Ğ¾Ñ‚ Ñ€ĞµĞ´ 8 = Ğ¸Ğ½Ğ´ĞµĞºÑ 7 Ğ² Ğ¼Ğ°ÑĞ¸Ğ²Ğ°
    for (var i = 7; i < rows.length; i++) {
      var row = rows[i];
      if (!row || row.length < 3) continue;
      var a0 = String(row[0]||'').trim();
      if (!a0 || a0.toLowerCase() === 'date') continue;
      var result = String(row[8]||'').toUpperCase().trim();
      if (result === 'WON' || result === 'LOST') continue;
      var home = String(row[2]||'').trim();
      var away = String(row[3]||'').trim();
      if (!home && !away) continue;
      found = row; foundIdx = i; break;
    }

    if (!found) {
      container.innerHTML = '<div class="empty-state"><span class="empty-icon">ğŸ“­</span>'
        + '<div style="font-size:20px;font-family:Orbitron;color:var(--gold);margin-bottom:8px">' + t('noDaily') + '</div>'
        + '<div style="color:var(--muted)">' + t('noDailyDesc') + '</div></div>';
      return;
    }

    // Ğ§ĞµÑ‚ĞµĞ¼ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ¿Ğ¾ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¸ Ğ¾Ñ‚ ÑĞ½Ğ¸Ğ¼ĞºĞ°Ñ‚Ğ°
    var dateVal = String(found[0]||'').trim();   // A â€” Ğ´Ğ°Ñ‚Ğ° Ğ½Ğ° Ğ·Ğ°Ğ¿Ğ¸ÑĞ°
    var market  = String(found[1]||'').trim();   // B â€” Ğ¿Ğ°Ğ·Ğ°Ñ€ (Over 1.5 Ğ¸ Ğ´Ñ€.)
    var home    = String(found[2]||'').trim();   // C â€” Ğ´Ğ¾Ğ¼Ğ°ĞºĞ¸Ğ½
    var away    = String(found[3]||'').trim();   // D â€” Ğ³Ğ¾ÑÑ‚
    var country = String(found[4]||'').trim();   // E â€” Ğ´ÑŠÑ€Ğ¶Ğ°Ğ²Ğ°
    var league  = String(found[5]||'').trim();   // F â€” Ğ»Ğ¸Ğ³Ğ°
    var gameTime= String(found[6]||'').trim();   // G â€” Ğ´Ğ°Ñ‚Ğ° Ğ¸ Ñ‡Ğ°Ñ Ğ½Ğ° Ğ¼Ğ°Ñ‡Ğ°
    var odds    = String(found[7]||'').trim();   // H â€” ĞºĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚

    // Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ñ€Ğ°Ğ¼Ğµ gameTime â€” Ğ°ĞºĞ¾ Ğµ Excel Ğ´Ğ°Ñ‚Ğ° Ñ‡Ğ¸ÑĞ»Ğ¾, ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€Ğ°Ğ¼Ğµ
    if (/^\d{5}$/.test(gameTime)) {
      // Excel serial date â†’ JS date
      var excelDate = new Date((parseInt(gameTime) - 25569) * 86400 * 1000);
      gameTime = excelDate.toLocaleDateString('en-GB') + ' ' + excelDate.toLocaleTimeString('en-GB', {hour:'2-digit',minute:'2-digit'});
    }

    // Debug collapse â€” Ğ¿Ğ¾Ğ»ĞµĞ·ĞµĞ½ Ğ·Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
    var debugHtml = '<details style="margin-bottom:14px">'
      + '<summary style="cursor:pointer;font-size:11px;color:var(--muted);list-style:none">ğŸ” Debug ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¸ (ĞºĞ»Ğ¸Ğº)</summary>'
      + '<div style="margin-top:8px;background:rgba(0,0,0,.4);border-radius:8px;padding:10px;font-family:monospace;font-size:11px;line-height:1.8">';
    ['A(date)','B(market)','C(home)','D(away)','E(country)','F(league)','G(time)','H(odds)','I(result)'].forEach(function(lbl,i) {
      debugHtml += '<span style="color:var(--muted)">' + lbl + ':</span> <span style="color:var(--gold)">' + escHtml(String(found[i]||'â€”')) + '</span>  ';
    });
    debugHtml += '</div></details>';

    container.innerHTML = debugHtml +
      '<div class="daily-card">'
      + '<div style="font-size:11px;text-transform:uppercase;letter-spacing:3px;color:var(--muted);margin-bottom:16px">â€” DAILY PICK â€”</div>'
      // ĞÑ‚Ğ±Ğ¾Ñ€Ğ¸ â€” Ğ³Ğ»Ğ°Ğ²Ğ½Ğ¾Ñ‚Ğ¾
      + '<div class="daily-teams">' + escHtml(home) + ' <span class="daily-vs">vs</span> ' + escHtml(away) + '</div>'
      // 4 Ğ¼ĞµÑ‚Ğ° box-Ğ°
      + '<div class="daily-meta-grid">'
      + (country   ? '<div class="daily-meta-box"><span class="daily-meta-icon">ğŸŒ</span><div class="daily-meta-label">' + t('country') + '</div><div class="daily-meta-value">' + escHtml(country) + '</div></div>' : '')
      + (league    ? '<div class="daily-meta-box"><span class="daily-meta-icon">ğŸ†</span><div class="daily-meta-label">' + t('leagueLabel') + '</div><div class="daily-meta-value">' + escHtml(league) + '</div></div>' : '')
      + (gameTime  ? '<div class="daily-meta-box"><span class="daily-meta-icon">ğŸ“…</span><div class="daily-meta-label">' + t('dateTime') + '</div><div class="daily-meta-value">' + escHtml(gameTime) + '</div></div>' : '')
      + (market    ? '<div class="daily-meta-box"><span class="daily-meta-icon">ğŸ¯</span><div class="daily-meta-label">' + t('marketLabel') + '</div><div class="daily-meta-value"><span class="badge badge-market">' + escHtml(normMkt(market)) + '</span></div></div>' : '')
      + '</div>'
      // ĞšĞ¾ĞµÑ„Ğ¸Ñ†Ğ¸ĞµĞ½Ñ‚ Ğ³Ğ¾Ğ»ÑĞ¼
      + (odds ? '<div class="daily-odds-wrap"><div class="daily-odds-label">' + t('oddsLabel') + '</div><div class="daily-odds-val">' + escHtml(odds) + '</div></div>' : '')
      + '</div>';
  }

  // â”€â”€â”€ VALUE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function renderValue(container) {
    var now=new Date(),active=[];
    var koRegex=/(\d{1,2})(?:st|nd|rd|th)?\s*(\d{2}:\d{2})/;
    for(var si=0;si<VALUE_SHEETS.length;si++){
      var sheet=VALUE_SHEETS[si];
      try{
        var rows=await fetchSheet(sheet.key);
        for(var i=3;i<rows.length;i++){
          var row=rows[i];
          if(!row||!Array.isArray(row)||row.length<26)continue;
          var isTracked=String(row[25]||'').trim();
          if(isTracked!=='1')continue;
          var dateStr=String(row[23]||'').trim();
          var koStr=String(row[22]||'').trim();
          var home=String(row[5]||'').trim();
          var away=String(row[6]||'').trim();
          var country=String(row[12]||'').trim();
          var league=String(row[24]||'').trim();
          var cOdds=String(row[2]||'').trim();
          if(!home&&!away)continue;
          if(!dateStr||!koStr||koStr.toLowerCase()==='ko')continue;
          var timeStr='',dayFromKo='';
          var match=koRegex.exec(koStr);
          if(match){dayFromKo=match[1].padStart(2,'0');timeStr=match[2];}
          else{var parts=koStr.split(/\s+/);timeStr=parts[parts.length-1];for(var p=0;p<parts.length;p++){if(/^\d{1,2}(st|nd|rd|th)?$/.test(parts[p])){dayFromKo=parts[p].replace(/(st|nd|rd|th)$/,'').padStart(2,'0');break;}}}
          if(!timeStr)continue;
          var kickoffStr=dateStr+'T'+timeStr+':00';
          var kickoff=new Date(kickoffStr);
          if(dayFromKo&&dayFromKo!==dateStr.split('-')[2]){var dp=dateStr.split('-');kickoffStr=dp[0]+'-'+dp[1]+'-'+dayFromKo+'T'+timeStr+':00';kickoff=new Date(kickoffStr);}
          if(isNaN(kickoff.getTime()))continue;
          var minsSince=(now-kickoff)/60000;
          if(minsSince>=110)continue;
          active.push({market:sheet.name,home:home,away:away,country:country,league:league,cOdds:cOdds,kickoff:kickoff,timeStr:timeStr});
        }
      }catch(e){console.warn(sheet.name,e);}
    }
    if(!active.length){
      container.innerHTML='<div class="empty-state"><span class="empty-icon">ğŸ’</span><div style="font-size:20px;font-family:Orbitron;color:var(--gold);margin-bottom:8px">'+t('noActiveBets')+'</div><div style="color:var(--muted)">'+t('checkBack')+'</div></div>';
      return;
    }
    active.sort(function(a,b){return a.kickoff-b.kickoff;});
    var html='<div style="font-size:13px;color:var(--muted);margin-bottom:16px">'+active.length+' active value bet'+(active.length!==1?'s':'')+'</div><div class="pred-list">';
    active.forEach(function(p){
      var minsSince=(now-p.kickoff)/60000,minsLeft=Math.round(110-minsSince),isLive=minsSince>=0;
      html+='<div class="pred-item"><div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:8px;margin-bottom:12px">'
        +'<div class="pred-match">'+escHtml(p.home)+' <span style="color:var(--muted)">vs</span> '+escHtml(p.away)+'</div>'
        +(isLive?'<span style="background:rgba(255,61,87,.15);border:1px solid rgba(255,61,87,.3);color:var(--red);padding:4px 10px;border-radius:20px;font-size:11px;font-weight:700;white-space:nowrap">ğŸ”´ LIVE â€¢ '+minsLeft+'m left</span>':'<span style="background:rgba(0,230,118,.1);border:1px solid rgba(0,230,118,.25);color:var(--green);padding:4px 10px;border-radius:20px;font-size:11px;font-weight:700;white-space:nowrap">â³ '+escHtml(p.timeStr)+'</span>')
        +'</div><div class="pred-meta">'
        +'<div><div class="meta-lbl">'+t('marketLabel')+'</div><div class="meta-val"><span class="badge badge-market">'+escHtml(p.market)+'</span></div></div>'
        +(p.country?'<div><div class="meta-lbl">'+t('country')+'</div><div class="meta-val">ğŸŒ '+escHtml(p.country)+'</div></div>':'')
        +(p.league?'<div><div class="meta-lbl">'+t('leagueLabel')+'</div><div class="meta-val">ğŸ† '+escHtml(p.league)+'</div></div>':'')
        +(p.cOdds?'<div><div class="meta-lbl">'+t('oddsLabel')+'</div><div class="meta-val" style="color:var(--gold);font-family:Orbitron;font-size:18px">'+escHtml(p.cOdds)+'</div></div>':'')
        +'</div></div>';
    });
    html+='</div>'; container.innerHTML=html;
  }

  // â”€â”€â”€ ACCA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function renderACCA(container) {
    var rows=await fetchSheet('acca'),couponStart=-1;
    for(var i=20;i<rows.length;i++){
      var row=rows[i]; if(!row||row.length<2)continue;
      var statusE=(row[4]||'').toUpperCase().trim();
      if(statusE==='WON'||statusE==='LOST')continue;
      if(!(row[0]||'').trim()&&!(row[1]||'').trim())continue;
      couponStart=i; break;
    }
    if(couponStart===-1){
      container.innerHTML='<div class="empty-state"><span class="empty-icon">ğŸ†</span><div style="font-size:20px;font-family:Orbitron;color:var(--gold);margin-bottom:8px">'+t('noAcca')+'</div><div style="color:var(--muted)">'+t('noAccaDesc')+'</div></div>';
      return;
    }
    var hr=rows[couponStart],couponDate=(hr[0]||'').trim(),numMatches=(hr[1]||'').trim(),totalOddsV=(hr[2]||'').trim();
    var matches=[];
    for(var j=couponStart+1;j<Math.min(couponStart+20,rows.length);j++){
      var r=rows[j]; if(!r||r.length<2)break;
      var mH=(r[1]||'').trim(),mA=(r[2]||'').trim(); if(!mH&&!mA)break;
      matches.push({home:mH,away:mA,market:(r[3]||'').trim(),odds:(r[4]||'').trim()});
    }
    var mHtml=matches.length?matches.map(function(m,i){
      return '<div style="background:rgba(255,255,255,.04);border:1px solid var(--border);border-radius:12px;padding:14px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px">'
        +'<div><div style="font-size:11px;color:var(--muted);margin-bottom:3px">Match '+(i+1)+'</div>'
        +'<div style="font-weight:700">'+escHtml(m.home)+' <span style="color:var(--muted)">vs</span> '+escHtml(m.away)+'</div></div>'
        +'<div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">'
        +(m.market?'<span class="badge badge-market">'+escHtml(normMkt(m.market))+'</span>':'')
        +(m.odds?'<span style="font-family:Orbitron;color:var(--gold);font-weight:700">'+escHtml(m.odds)+'</span>':'')
        +'</div></div>';
    }).join(''):'<div style="color:var(--muted);text-align:center;padding:16px">'+t('noData')+'</div>';
    container.innerHTML='<div style="background:linear-gradient(135deg,rgba(245,184,0,.08),rgba(155,93,229,.05));border:2px solid var(--border-gold);border-radius:16px;padding:24px">'
      +'<div style="display:flex;flex-wrap:wrap;gap:12px;justify-content:space-between;align-items:center;margin-bottom:20px">'
      +'<div><div style="font-size:11px;text-transform:uppercase;letter-spacing:2px;color:var(--muted)">ACCA Coupon</div>'+(couponDate?'<div style="font-size:13px;color:var(--muted);margin-top:4px">ğŸ“… '+escHtml(couponDate)+'</div>':'')+'</div>'
      +'<div style="display:flex;gap:12px;flex-wrap:wrap">'
      +(numMatches?'<div style="text-align:center"><div style="font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--muted)">'+t('matchesLabel')+'</div><div style="font-family:Orbitron;font-size:28px;font-weight:900;color:var(--blue)">'+escHtml(numMatches)+'</div></div>':'')
      +(totalOddsV?'<div style="text-align:center"><div style="font-size:10px;text-transform:uppercase;letter-spacing:1px;color:var(--muted)">'+t('totalOdds')+'</div><div style="font-family:Orbitron;font-size:28px;font-weight:900;color:var(--gold)">'+escHtml(totalOddsV)+'</div></div>':'')
      +'</div></div><div style="display:grid;gap:10px">'+mHtml+'</div></div>';
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  COMMENTS
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  function syncCommentsUI(){var has=!!currentUser;document.getElementById('cFormWrap').style.display=has?'block':'none';document.getElementById('cLoginPrompt').style.display=has?'none':'block';}
  async function loadComments(){
    try{var res=await db.from('comments').select('*').is('parent_id',null).order('created_at',{ascending:false});if(res.error)throw res.error;await renderComments(res.data||[]);}
    catch(e){console.error('Comments:',e);document.getElementById('cList').innerHTML='<div class="empty-state"><span class="empty-icon">âŒ</span>Error</div>';}
  }
  async function renderComments(comments){
    var el=document.getElementById('cList');
    if(!comments.length){el.innerHTML='<div class="empty-state"><span class="empty-icon">ğŸ’­</span>No comments yet</div>';return;}
    var html='';
    for(var i=0;i<comments.length;i++){var c=comments[i];var r2=await db.from('comments').select('*').eq('parent_id',c.id).order('created_at');html+=buildComment(c,r2.data||[]);}
    el.innerHTML=html;
  }
  function buildComment(c,replies){
    replies=replies||[];
    var canDel=currentUser&&(currentUser.username===c.username||currentUser.isAdmin);
    var rHtml='';for(var i=0;i<replies.length;i++)rHtml+=buildReply(replies[i]);
    return '<div class="comment-card">'
      +'<div class="comment-head"><div class="comment-user '+(c.is_admin?'is-admin':'')+'">'
      +escHtml(c.username)+(c.is_admin?' <span class="admin-badge">ADMIN</span>':'')
      +'</div><div class="comment-time">'+timeAgo(c.created_at)+'</div></div>'
      +'<div class="comment-body">'+escHtml(c.comment_text)+'</div>'
      +'<div class="comment-actions">'
      +(currentUser?'<button class="action-btn" onclick="openReply('+c.id+')">'+t('reply')+'</button>':'')
      +(canDel?'<button class="action-btn" style="color:var(--red)" onclick="delComment('+c.id+')">'+t('delete')+'</button>':'')
      +'</div><div id="rp'+c.id+'"></div>'
      +(rHtml?'<div class="reply-indent">'+rHtml+'</div>':'')+'</div>';
  }
  function buildReply(r){
    var canDel=currentUser&&(currentUser.username===r.username||currentUser.isAdmin);
    return '<div style="background:rgba(255,255,255,.03);border-radius:10px;padding:12px;margin-bottom:8px">'
      +'<div class="comment-head"><div class="comment-user '+(r.is_admin?'is-admin':'')+'">'
      +escHtml(r.username)+(r.is_admin?' <span class="admin-badge">ADMIN</span>':'')
      +'</div><div class="comment-time">'+timeAgo(r.created_at)+'</div></div>'
      +'<div class="comment-body">'+escHtml(r.comment_text)+'</div>'
      +(canDel?'<button class="action-btn" style="color:var(--red)" onclick="delComment('+r.id+')">'+t('delete')+'</button>':'')
      +'</div>';
  }
  function openReply(id){
    if(!currentUser){openAuthModal();return;}
    document.querySelectorAll('.reply-box').forEach(function(b){b.remove();});
    var wrap=document.getElementById('rp'+id); if(!wrap)return;
    wrap.innerHTML='<div class="reply-box"><textarea class="reply-textarea" id="rt'+id+'" placeholder="'+t('shareThoughts')+'" maxlength="500"></textarea>'
      +'<div style="display:flex;gap:8px"><button class="btn btn-gold" style="padding:8px 16px;font-size:12px" onclick="sendReply('+id+')">'+t('post')+'</button>'
      +'<button class="btn btn-ghost" style="padding:8px 16px;font-size:12px" onclick="document.getElementById(\'rp'+id+'\').innerHTML=\'\'">Cancel</button></div></div>';
    var ta=document.getElementById('rt'+id); if(ta)ta.focus();
  }
  async function postComment(){
    if(!currentUser){openAuthModal();return;}
    var txt=document.getElementById('cInput').value.trim(); if(!txt){alert(t('writeSomething'));return;}
    try{var res=await db.from('comments').insert([{username:currentUser.username,is_admin:currentUser.isAdmin||false,comment_text:txt,parent_id:null}]);if(res.error)throw res.error;document.getElementById('cInput').value='';document.getElementById('cCount').textContent='0 / 500';await loadComments();}
    catch(e){alert(t('errorPost'));}
  }
  async function sendReply(parentId){
    if(!currentUser)return;
    var ta=document.getElementById('rt'+parentId),txt=ta?ta.value.trim():''; if(!txt){alert(t('writeSomething'));return;}
    try{var res=await db.from('comments').insert([{username:currentUser.username,is_admin:currentUser.isAdmin||false,comment_text:txt,parent_id:parentId}]);if(res.error)throw res.error;var wrap=document.getElementById('rp'+parentId);if(wrap)wrap.innerHTML='';await loadComments();}
    catch(e){alert(t('errorReply'));}
  }
  async function delComment(id){
    if(!currentUser||!confirm(t('confirmDelete')))return;
    try{var res=await db.from('comments').delete().eq('id',id);if(res.error)throw res.error;await loadComments();}
    catch(e){alert(t('errorDelete'));}
  }

  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  //  INIT
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  document.getElementById('cInput').addEventListener('input',function(){document.getElementById('cCount').textContent=this.value.length+' / 500';});
  updateAuthSwitch(); // set initial auth switch text

  async function init() {
    console.log('DeepStats PRO v3.3 init...');
    try {
      var data=await loadInitial();
      if(!data.length)console.warn('No data! Check RLS policies for: '+TABLE_NEW+', '+TABLE_OLD);
      allMatches=data; filtered=data; totalLoaded=data.length;
      calcAndShow(data); renderMarkets(data); renderLast20(data); initFilters();
      syncCommentsUI(); await loadComments();
      setInterval(loadComments,30000);
      console.log('Ready â€” '+data.length+' records');
    }catch(err){
      console.error('Init error:',err);
      alert('Ğ“Ñ€ĞµÑˆĞºĞ°: '+err.message);
    }
  }
  init();
  </script>
</body>
</html>